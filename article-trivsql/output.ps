%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: output.dvi
%%Pages: 28
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Helvetica-Bold Palatino-Bold Palatino-Roman Courier
%%+ Palatino-Italic
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips -q output.dvi -o output.ps
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2002.10.15:1111
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "22 June 1996",
%   filename = "8r.enc",
%   email = "kb@@mail.tug.org",
%   address = "135 Center Hill Rd. // Plymouth, MA 02360",
%   codetable = "ISO/ASCII",
%   checksum = "119     662    4424",
%   docstring = "Encoding for TrueType or Type 1 fonts to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there down to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
%%BeginProcSet: color.pro
%!
TeXDict begin/setcmykcolor where{pop}{/setcmykcolor{dup 10 eq{pop
setrgbcolor}{1 sub 4 1 roll 3{3 index add neg dup 0 lt{pop 0}if 3 1 roll
}repeat setrgbcolor pop}ifelse}B}ifelse/TeXcolorcmyk{setcmykcolor}def
/TeXcolorrgb{setrgbcolor}def/TeXcolorgrey{setgray}def/TeXcolorgray{
setgray}def/TeXcolorhsb{sethsbcolor}def/currentcmykcolor where{pop}{
/currentcmykcolor{currentrgbcolor 10}B}ifelse/DC{exch dup userdict exch
known{pop pop}{X}ifelse}B/GreenYellow{0.15 0 0.69 0 setcmykcolor}DC
/Yellow{0 0 1 0 setcmykcolor}DC/Goldenrod{0 0.10 0.84 0 setcmykcolor}DC
/Dandelion{0 0.29 0.84 0 setcmykcolor}DC/Apricot{0 0.32 0.52 0
setcmykcolor}DC/Peach{0 0.50 0.70 0 setcmykcolor}DC/Melon{0 0.46 0.50 0
setcmykcolor}DC/YellowOrange{0 0.42 1 0 setcmykcolor}DC/Orange{0 0.61
0.87 0 setcmykcolor}DC/BurntOrange{0 0.51 1 0 setcmykcolor}DC
/Bittersweet{0 0.75 1 0.24 setcmykcolor}DC/RedOrange{0 0.77 0.87 0
setcmykcolor}DC/Mahogany{0 0.85 0.87 0.35 setcmykcolor}DC/Maroon{0 0.87
0.68 0.32 setcmykcolor}DC/BrickRed{0 0.89 0.94 0.28 setcmykcolor}DC/Red{
0 1 1 0 setcmykcolor}DC/OrangeRed{0 1 0.50 0 setcmykcolor}DC/RubineRed{
0 1 0.13 0 setcmykcolor}DC/WildStrawberry{0 0.96 0.39 0 setcmykcolor}DC
/Salmon{0 0.53 0.38 0 setcmykcolor}DC/CarnationPink{0 0.63 0 0
setcmykcolor}DC/Magenta{0 1 0 0 setcmykcolor}DC/VioletRed{0 0.81 0 0
setcmykcolor}DC/Rhodamine{0 0.82 0 0 setcmykcolor}DC/Mulberry{0.34 0.90
0 0.02 setcmykcolor}DC/RedViolet{0.07 0.90 0 0.34 setcmykcolor}DC
/Fuchsia{0.47 0.91 0 0.08 setcmykcolor}DC/Lavender{0 0.48 0 0
setcmykcolor}DC/Thistle{0.12 0.59 0 0 setcmykcolor}DC/Orchid{0.32 0.64 0
0 setcmykcolor}DC/DarkOrchid{0.40 0.80 0.20 0 setcmykcolor}DC/Purple{
0.45 0.86 0 0 setcmykcolor}DC/Plum{0.50 1 0 0 setcmykcolor}DC/Violet{
0.79 0.88 0 0 setcmykcolor}DC/RoyalPurple{0.75 0.90 0 0 setcmykcolor}DC
/BlueViolet{0.86 0.91 0 0.04 setcmykcolor}DC/Periwinkle{0.57 0.55 0 0
setcmykcolor}DC/CadetBlue{0.62 0.57 0.23 0 setcmykcolor}DC
/CornflowerBlue{0.65 0.13 0 0 setcmykcolor}DC/MidnightBlue{0.98 0.13 0
0.43 setcmykcolor}DC/NavyBlue{0.94 0.54 0 0 setcmykcolor}DC/RoyalBlue{1
0.50 0 0 setcmykcolor}DC/Blue{1 1 0 0 setcmykcolor}DC/Cerulean{0.94 0.11
0 0 setcmykcolor}DC/Cyan{1 0 0 0 setcmykcolor}DC/ProcessBlue{0.96 0 0 0
setcmykcolor}DC/SkyBlue{0.62 0 0.12 0 setcmykcolor}DC/Turquoise{0.85 0
0.20 0 setcmykcolor}DC/TealBlue{0.86 0 0.34 0.02 setcmykcolor}DC
/Aquamarine{0.82 0 0.30 0 setcmykcolor}DC/BlueGreen{0.85 0 0.33 0
setcmykcolor}DC/Emerald{1 0 0.50 0 setcmykcolor}DC/JungleGreen{0.99 0
0.52 0 setcmykcolor}DC/SeaGreen{0.69 0 0.50 0 setcmykcolor}DC/Green{1 0
1 0 setcmykcolor}DC/ForestGreen{0.91 0 0.88 0.12 setcmykcolor}DC
/PineGreen{0.92 0 0.59 0.25 setcmykcolor}DC/LimeGreen{0.50 0 1 0
setcmykcolor}DC/YellowGreen{0.44 0 0.74 0 setcmykcolor}DC/SpringGreen{
0.26 0 0.76 0 setcmykcolor}DC/OliveGreen{0.64 0 0.95 0.40 setcmykcolor}
DC/RawSienna{0 0.72 1 0.45 setcmykcolor}DC/Sepia{0 0.83 1 0.70
setcmykcolor}DC/Brown{0 0.81 1 0.60 setcmykcolor}DC/Tan{0.14 0.42 0.56 0
setcmykcolor}DC/Gray{0 0 0 0.50 setcmykcolor}DC/Black{0 0 0 1
setcmykcolor}DC/White{0 0 0 0 setcmykcolor}DC end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (output.dvi)
@start
%DVIPSBitmapFont: Fa cmmi9 9 2
/Fa 2 63 df<171C177EEE01FEEE07FCEE1FF0EE7FC0923801FF00ED07FCED1FF0ED7FC0
4A48C7FCEC07FCEC1FF0EC7FC04948C8FCEB07FCEB1FF0EB7FC04848C9FCEA07FCEA1FF0
EA7FC048CAFCA2EA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FCEB01FF9038007F
C0EC1FF0EC07FCEC01FF9138007FC0ED1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE
01FEEE007E171C2F2E7AA93C>60 D<127012FCB4FCEA7FC0EA1FF0EA07FCEA01FF38007F
C0EB1FF0EB07FCEB01FF9038007FC0EC1FF0EC07FCEC01FF9138007FC0ED1FF0ED07FCED
01FF9238007FC0EE1FF0EE07FCEE01FEA2EE07FCEE1FF0EE7FC0923801FF00ED07FCED1F
F0ED7FC04A48C7FCEC07FCEC1FF0EC7FC04948C8FCEB07FCEB1FF0EB7FC04848C9FCEA07
FCEA1FF0EA7FC048CAFC12FC12702F2E7AA93C>62 D E
%EndDVIPSBitmapFont
/Fb 106[40 149[{TeXBase1Encoding ReEncodeFont}1 66.4176
/Palatino-Roman rf /Fc 135[51 2[56 30 51 36 1[56 56 56
81 25 51 1[25 56 56 30 51 56 51 1[51 13[61 1[71 61 2[76
56 2[25 1[71 2[66 66 1[66 6[30 11[25 6[25 36[56 2[{
TeXBase1Encoding ReEncodeFont}33 91.3242 /Helvetica-Bold
rf /Fd 134[42 42 60 42 46 28 32 32 38 42 37 46 65 23
37 1[23 42 42 23 32 42 34 38 37 1[42 7[78 60 65 51 46
55 65 51 65 65 78 46 2[28 65 1[46 51 65 55 51 60 3[50
1[21 21 42 42 42 42 42 42 42 42 42 42 25 21 28 21 1[32
28 28 23 36[44 2[{TeXBase1Encoding ReEncodeFont}67 83.022
/Palatino-Italic rf /Fe 107[45 22[45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 1[45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 1[45 45 45 45 45 45 45 45 45
45 45 45 45 1[45 45 45 45 45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 45 45 45 45 33[{
TeXBase1Encoding ReEncodeFont}91 74.7198 /Courier rf
/Ff 206[25 49[{TeXBase1Encoding ReEncodeFont}1 49.8132
/Palatino-Roman rf /Fg 107[42 42 24[42 46 43 69 47 50
27 35 33 46 50 45 48 73 24 46 19 24 48 46 28 40 51 37
46 42 7[55 1[83 60 65 51 44 55 65 50 65 69 79 51 2[28
69 63 46 51 64 59 51 65 1[37 4[21 5[42 42 42 42 1[50
21 28 21 1[32 28 28 23 3[42 31[50 50 2[{TeXBase1Encoding ReEncodeFont}
67 83.022 /Palatino-Roman rf /Fh 134[56 56 1[56 61 33
56 39 61 61 61 61 89 28 2[28 61 61 33 56 61 56 61 56
9[95 2[61 67 1[78 4[61 2[28 1[78 3[73 1[73 1[61 63[{
TeXBase1Encoding ReEncodeFont}32 100.457 /Helvetica-Bold
rf /Fi 134[46 42 1[46 51 28 37 32 51 51 46 51 74 28 2[28
51 46 32 42 51 37 51 42 1[42 7[83 1[65 55 51 60 69 51
1[69 1[51 2[32 1[69 1[51 69 60 1[65 1[37 4[21 42 2[42
42 42 42 1[42 42 1[21 28 41[51 3[{TeXBase1Encoding ReEncodeFont}50
83.022 /Palatino-Bold rf /Fj 139[37 61 3[68 68 1[31 5[37
61 2[68 61 12[68 5[80 10[80 67[{TeXBase1Encoding ReEncodeFont}12
110.502 /Helvetica-Bold rf /Fk 134[74 2[74 82 45 74 52
82 82 82 82 1[37 2[37 1[82 45 74 1[74 1[74 13[89 1[104
4[82 10[97 6[45 58[{TeXBase1Encoding ReEncodeFont}22
133.707 /Helvetica-Bold rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop Black 0 TeXcolorgray Black Black 424 104 a Fk(trivsql:)37
b(A)g(trivial)h(SQL)f(engine)g(f)m(or)f(y)m(our)h(application)197
308 y Fj(T)-9 b(ab)o(le)30 b(of)g(Contents)p 0 TeXcolorgray
596 455 a Fi(Introduction)p Black Black 12 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
0 TeXcolorgray -1 w(3)p Black 0 TeXcolorgray 596 566
a(About)19 b(the)h(author)p Black Black 10 w(.)p Black
Black -2 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray -1 w(3)p
Black 0 TeXcolorgray 596 677 a(An)g(introduction)e(to)j(tdb)p
Black Black 12 w(.)p Black Black -1 w(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
-1 w(3)p Black 0 TeXcolorgray 596 788 a(Why)f(trivsql?)p
Black Black 7 w(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray -1 w(3)p
Black 0 TeXcolorgray 596 900 a(Why)g(SQL?)p Black Black
3 w(.)p Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray -1 w(4)p
Black 0 TeXcolorgray 596 1011 a(The)g(current)g(state)f(of)i(play)p
Black Black 7 w(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black 0 TeXcolorgray
-1 w(5)p Black 0 TeXcolorgray 596 1122 a(Interface)e(to)h(trivsql)p
Black Black 1 w(.)p Black Black -1 w(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray -1 w(5)p Black 0
TeXcolorgray 596 1233 a(An)g(example)e(usage)p Black
Black 10 w(.)p Black Black -2 w(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray -1 w(5)p Black 0 TeXcolorgray
596 1345 a(Genstruct)h(as)h(an)g(alternative)p Black
Black 1 w(.)p Black Black -4 w(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black 0 TeXcolorgray -1 w(6)p Black 0
TeXcolorgray 596 1456 a(What)f(is)h(genstruct?)p Black
Black 5 w(.)p Black Black -1 w(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray -1 w(6)p Black 0 TeXcolorgray
596 1567 a(The)g(other)g(side)f(of)j(the)d(equation)p
Black Black 15 w(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black 0 TeXcolorgray -1 w(9)p Black 0 TeXcolorgray
596 1678 a(Genstruct)g(pros)h(and)g(cons)p Black Black
14 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black 0 TeXcolorgray -1 w(9)p
Black 0 TeXcolorgray 596 1790 a(Conclusion)p Black Black
17 w(.)p Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black 0 TeXcolorgray(10)p Black 0 TeXcolorgray
596 1901 a(Code)g(listings)p Black Black 12 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black(.)p Black Black -1 w(.)p
Black Black(.)p Black Black(.)p Black Black(.)p Black
Black -1 w(.)p Black Black(.)p Black Black(.)p Black
Black(.)p Black Black -1 w(.)p Black Black(.)p Black
Black(.)p Black Black(.)p Black Black -1 w(.)p Black
Black(.)p Black Black(.)p Black Black(.)p Black Black
-1 w(.)p Black Black(.)p Black Black(.)p Black Black(.)p
Black Black -1 w(.)p Black Black(.)p Black Black(.)p
Black Black(.)p Black Black -1 w(.)p Black Black(.)p
Black 0 TeXcolorgray(10)p Black Black Black eop
%%Page: 2 2
2 1 bop Black 0 TeXcolorgray Black Black Black Black
eop
%%Page: 3 3
3 2 bop Black 0 TeXcolorgray Black Black 197 89 a Fh(Intr)n(oduction)
596 231 y Fi(trivsql)30 b Fg(is)i(a)e(simple)i(SQL)f(engine,)h
(implemented)f(on)h(the)g Fi(tdb)e Fg(database)g(engine.)h(The)h(in-)
596 322 y(tention)e(of)f Fi(trivsql)g Fg(is)h(that)f(it)h(is)g
(embedded)e(into)i(your)g(application,)f(allowing)i(the)e(use)h(of)596
413 y(familiar)20 b(SQL)g(constr)o(ucts)i(for)e(accessing)h(data)f
(stor)o(ed)g(within)i(your)f(application.)596 546 y Fi(trivsql)d
Fg(is)j(licensed)f(under)f(the)h(terms)g(of)g(the)g(GNU)g(GPL,)g(as)g
(is)g(the)g Fi(tdb)f Fg(engine)i(upon)f(which)596 637
y(it)g(depends.)197 956 y Fh(About)29 b(the)g(author)596
1097 y Fg(Michael)h(has)h(been)f(working)i(in)g(the)f(image)f(pr)o
(ocessing)i(\002eld)e(for)h(several)f(years,)g(includ-)596
1188 y(ing)d(a)f(couple)h(of)g(years)f(managing)i(and)e(developing)h
(lar)o(ge)f(image)h(databases)e(for)i(an)f(Aus-)596 1280
y(tralian)16 b(government)h(department.)f(He)g(curr)o(ently)g(works)i
(for)e(T)o(OWER)h(Softwar)o(e,)e(who)i(man-)596 1371
y(ufactur)o(e)28 b(a)h(world)i(leading)e(EDMS)g(and)h(Recor)o(ds)g
(Management)f(package)g(named)g(TRIM.)596 1462 y(Michael)21
b(is)i(also)g(the)g(developer)f(of)g(Panda,)g(an)g(open)h(sour)o(ce)f
(PDF)h(generation)g(API,)f(as)h(well)596 1554 y(as)31
b(being)h(the)g(maintainer)f(of)h(the)f(comp.text.pdf)g(USENET)f(fr)o
(equently)h(asked)g(questions)596 1645 y(document.)596
1778 y(Michael)20 b(has)g(a)h(website)g(at)f(http://www)-8
b(.stillhq.com.)197 2096 y Fh(An)28 b(intr)n(oduction)j(to)d(tdb)596
2237 y Fi(tdb)21 b Fg(is)h(a)g(\(name,)f(value\))g(pair)h(database)e
(similar)j(to)f Fi(gdbm)p Fg(.)f(It)i(was)f(originally)h(implemented)
596 2329 y(for)g(the)i(Samba)d(pr)o(oject,)i(as)g(a)f(way)h(of)g
(avoiding)h(having)f(to)g(implement)h(a)f(lar)o(ge)f(number)h(of)596
2420 y(in)f(memory)g(linked)g(lists)h(for)e(storing)i(usage)e(and)h
(access)f(information.)h(The)g(code)f(for)h Fi(tdb)f
Fg(is)596 2511 y(available)d(fr)o(om)h(the)h(Samba)f(CVS)g(server)-6
b(.)596 2644 y(T)e(o)19 b(quote)g(fr)o(om)g(the)g(Samba)e(sour)o(ce)i
(code:)f(\223This)h(is)g(a)f(simple)i(database)d(API.)h(It)h(was)f
(inspir)o(ed)596 2736 y(by)23 b(the)h(r)o(ealisation)g(that)f(in)i
(Samba)d(we)i(have)f(several)g(ad-hoc)g(bits)h(of)g(code)g(that)f
(essentially)596 2827 y(implement)g(small)h(databases)d(for)i(sharing)g
(str)o(uctur)o(es)g(between)f(parts)h(of)g(Samba.)e(As)i(I)g(was)596
2918 y(about)33 b(to)g(add)f(another)i(I)f(r)o(ealised)e(that)j(a)e
(generic)h(database)f(module)h(was)g(called)g(for)g(to)596
3010 y(r)o(eplace)20 b(all)i(the)g(ad-hoc)f(bits.)h(I)g(based)f(the)h
(interface)f(on)i(gdbm.)f(I)g(couldn't)g(use)g(gdbm)g(as)g(we)596
3101 y(need)e(to)h(be)f(able)h(to)g(have)f(multiple)h(writers)g(to)g
(the)g(databases)e(at)i(one)g(time.\224)596 3234 y(T)-8
b(o)21 b(make)f(use)h(of)g(a)f Fi(tdb)g Fg(database)f(at)h(the)h(most)h
(trivial)e(level,)h(you)g(open)g(the)g(database)e(with)i(a)596
3325 y Fi(tdb_open)i Fg(function)j(call,)f(you)h(can)f(then)h(add)e
(pairs)h(to)h(the)f(database)f(using)i(the)g Fi(tdb_store)596
3416 y Fg(function,)39 b(and)f(r)o(etrieve)g(pairs)g(fr)o(om)g(the)h
(database)e(with)j(the)f Fi(tdb_fetch)e Fg(function.)i(The)596
3508 y(database)18 b(is)k(closed)e(when)i(you)f(ar)o(e)e(\002nished)j
(with)f(the)g(via)g(the)g Fi(tdb_close)d Fg(function.)3436
3474 y Ff(1)197 3826 y Fh(Wh)n(y)28 b(trivsql?)596 3967
y Fg(The)g(functionality)i(of)o(fer)o(ed)d(by)i Fi(tdb)f
Fg(is)h(satisfactory)f(for)h(simple)g(databases)e(wher)o(e)i(all)f(you)
596 4059 y(want)22 b(to)h(stor)o(e)f(is)g(small)h(nuggets)g(of)f(data.)
f(For)i(instance,)f(when)h(you)g(want)f(to)h(stor)o(e)f(that)g(the)596
4150 y(user)e(Daniel)h(is)g(logged)g(on,)g(then)h(a)e(piece)g(of)h
(code)f(such)h(as:)685 4315 y Fe(TDB_CONTEXT)43 b(db;)685
4397 y(TDB_DATA)h(dbkey,)f(dbdata;)685 4562 y(//)i(Open)f(the)g
(database)685 4644 y(document->db)f(=)i(tdb_open)e(\("foo.tdb",)g(0,)
1806 4726 y(TDB_CLEAR_IF_FIRST,)f(O_RDWR)h(|)i(O_CREAT)f(|)g(O_TRUNC,)
1806 4808 y(0600\);)685 4973 y(//)h(Store)f(the)g(value)685
5055 y(dbkey.dptr)f(=)i("Daniel";)685 5137 y(dbkey.dsize)e(=)i(strlen)f
(\(key\))g(+)g(1;)685 5219 y(dbdata.dptr)f(=)i("LoggedOn";)685
5301 y(dbdata.dsize)e(=)i(strlen)e(\(value\))h(+)h(1;)685
5466 y(if)g(\(tdb_store)e(\(db,)h(dbkey,)g(dbdata,)f(TDB_REPLACE\))g
(!=)i(0\))p Black 3642 5585 a Fd(3)p Black eop
%%Page: 4 4
4 3 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 775 89 a Fe({)865 171 y(fprintf\(stderr,)42 b("Could)i(not)g
(store)g(value"\);)775 253 y(})596 428 y Fg(And)20 b(to)h(r)o(etrieve)e
(the)i(value:)685 593 y Fe(TDB_CONTEXT)43 b(db;)685 675
y(TDB_DATA)h(dbkey,)f(dbdata;)685 840 y(//)i(Open)f(the)g(database)685
922 y(document->db)f(=)i(tdb_open)e(\("foo.tdb",)g(0,)1806
1004 y(TDB_CLEAR_IF_FIRST,)f(O_RDWR)h(|)i(O_CREAT)f(|)g(O_TRUNC,)1806
1086 y(0600\);)685 1251 y(//)h(Fetch)f(the)g(value)685
1333 y(dbkey.dptr)f(=)i("Daniel";)685 1415 y(dbkey.dsize)e(=)i(strlen)f
(\(key\))g(+)g(1;)685 1579 y(dbdata)g(=)h(tdb_fetch)e(\(document->db,)f
(dbkey\);)596 1754 y Fg(This)31 b(doesn't)g(work)h(so)f(well)g(when)h
(the)f(data)e(you)j(want)e(to)i(stor)o(e)e(is)h(mor)o(e)g(complex.)g
(For)596 1845 y(example,)21 b(let's)i(imagine)f(that)h(we)f(want)h(to)f
(stor)o(e)g(some)h(mor)o(e)f(information)i(about)e(Daniel)h(--)596
1936 y(for)e(instance)g(how)i(many)e(bytes)h(he)f(has)h(transfer)o(ed)d
(this)k(session)f(and)f(a)g(list)h(of)g(his)g(favourite)596
2028 y(users.)e(I)h(can)f(think)i(of)f(four)f(ways)h(that)g(we)g(can)f
(stor)o(e)h(this)g(information)h(in)f(a)f Fi(tdb)g Fg(database:)p
Black 712 2368 a(1.)p Black 20 w(W)-8 b(e)38 b(can)g(de\002ne)h(a)f
(str)o(uctur)o(e)f(that)i(contains)g(these)f(elements,)h(and)f(then)h
(stor)o(e)f(the)795 2459 y(pointer)c(to)g(this)g(str)o(uctur)o(e)f(in)i
(the)e Fi(tdb)p Fg(.)g(The)h(pr)o(oblem)f(with)h(this)h(is)f(that)g(it)
f(doesn't)795 2551 y(persist)f(acr)o(oss)h(r)o(estarts)e(of)i(the)f(pr)
o(ogram,)g(because)g(the)h(pointer)f(will)i(no)f(longer)g(be)795
2642 y(valid.)p Black 712 2775 a(2.)p Black 20 w(W)-8
b(e)26 b(can)f(use)h(a)g(series)g(of)g(inter)o(estingly)g(named)g
(keys,)g(each)f(storing)i(a)e(piece)h(of)g(infor)o(-)795
2866 y(mation.)21 b(For)g(example:)p Black 911 2999 a(a.)p
Black 20 w(daniel-bytestransfer)o(ed)p Black 907 3132
a(b.)p Black 20 w(daniel-friends)p Black 916 3265 a(c.)p
Black 20 w(et)g(cetera)795 3398 y(The)30 b(pr)o(oblem)f(with)i(this)g
(is)f(that)g(it)h(pr)o(oduces)e(horribly)i(verbose)e(code,)h(because)f
(the)795 3489 y(code)20 b(to)h(r)o(ead)e(a)i(single)g(key)g(is)g(r)o
(epeated)e(all)h(over)h(the)g(place.)p Black 712 3622
a(3.)p Black 20 w(W)-8 b(e)23 b(can)f(push)i(all)f(the)g(information)h
(into)f(one)h(string,)f(and)g(then)g(stor)o(e)g(that)g(in)g(the)g
Fi(tdb)p Fg(,)795 3713 y(but)d(this)g(means)g(that)g(we)g(have)f(to)i
(handle)e(parsing)h(the)g(information)h(again)f(when)g(you)795
3804 y(need)26 b(it)g(back.)g(Since)g(writing)h Fi(trivsql)e
Fg(the)i(Samba)e(team)h(has)g(dealt)f(with)j(exactly)d(this)795
3896 y(pr)o(oblem)h(in)i(this)f(manner)-6 b(.)27 b(T)-8
b(o)27 b(ease)f(the)h(implementation,)h(Dr)f(Andr)o(ew)f(T)-7
b(ridgell)26 b(has)795 3987 y(written)h Fi(genstruct)p
Fg(,)e(which)j(takes)e(c)h(str)o(uctur)o(es)g(\(including)g(pointers\))
g(and)g(serializes)795 4078 y(them)21 b(into)h(strings.)f
Fi(genstruct)e Fg(is)i(available)f(fr)o(om)g(http://www)-8
b(.samba.or)o(g.)p Black 712 4211 a(4.)p Black 20 w(Y)g(ou)25
b(can)e(use)h Fi(trivsql)p Fg(,)f(which)i(looks)g(after)e(all)g(the)i
(ugliness)f(for)g(you,)g(and)g(allows)g(you)795 4302
y(to)d(perform)g(select)g(and)g(insert)g(statements)g(in)h(a)f(manner)g
(familiar)f(to)i(many)f(pr)o(ogram-)795 4394 y(mers.)197
4845 y Fh(Wh)n(y)28 b(SQL?)596 4986 y Fg(SQL)e(was)h(selected)f(as)h(a)
f(logical)h(layer)g(over)f Fi(tdb)g Fg(because)g(ther)o(e)h(ar)o(e)e
(many)i(developers)f(in)596 5078 y(the)c(world)i(which)f(ar)o(e)f(alr)o
(eady)f(familiar)h(with)h(it.)g(It)g(is)g(also)g(r)o(elatively)f
(simple)h(to)g(parse)f(and)596 5169 y(pr)o(ocess)e(the)h(commands.)p
Black 197 5585 a Fd(4)p Black eop
%%Page: 5 5
5 4 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fc(P)m(ar)o(sing)k(SQL)596 226 y Fg(The)h(SQL)h(parser)f
(for)g Fi(trivsql)g Fg(is)h(implemented)g(in)h Fi(\003ex)d
Fg(and)h Fi(bison)p Fg(,)g(the)h(listings)h(for)f(which)596
317 y(ar)o(e)h(included)h(at)h(the)g(end)f(of)h(this)g(article.)f
(These)h(\002les)g(de\002ne)g(a)f(simple)h(grammar)f(for)h(the)596
409 y(supported)20 b(SQL)g(commands.)596 542 y(The)g(following)j(SQL)d
(commands)h(ar)o(e)e(curr)o(ently)i(supported:)p Black
596 757 a Fb(\225)p Black 43 w Fi(CREA)-8 b(TE)p Fg(:)27
b(used)g(to)h(cr)o(eate)e(a)h(table,)g(for)g(example)g
Fd(CREA)-5 b(TE)28 b(T)-8 b(ABLE)27 b(newtable)h(\(cola,)f(colb,)679
849 y(colc\);)p Fg(.)h(Inside)i(the)g(brackets)f(is)h(a)f(comma)h
(separated)e(list)j(of)f(column)g(names.)g(Note)g(that)679
940 y Fi(trivsql)20 b Fg(doesn't)h(curr)o(ently)g(support)g(datatypes)f
(for)h(the)h(columns)g(of)f(tables,)g(so)g(it)h(is)f(up)h(to)679
1031 y(the)g(user)h(to)g(make)f(sur)o(e)g(that)h(they)g(parse)e(the)i
(string)h(values)e(in)h(each)f(column)i(corr)o(ectly)e(--)679
1123 y(this)f(will)h(change)e(in)h(a)g(later)f(version)h(of)g
Fi(trivsql)p Fg(.)p Black 596 1256 a Fb(\225)p Black
43 w Fi(INSER)-5 b(T)p Fg(:)24 b(for)g(example)f Fd(INSER)-5
b(T)24 b(INT)o(O)e(newtable)j(\(cola,)e(colc\))g(V)-17
b(ALUES)23 b(\('123',)f('banana'\);)p Fg(.)679 1347 y(Her)o(e)27
b(we)h(ar)o(e)e(inserting)j(the)g(given)f(values)g(into)h(the)f(table)g
Fd(newtable)h Fg(as)e(speci\002ed)h(in)h(the)679 1438
y(column)h(list.)g Fi(trivsql)f Fg(supports)h(NULL)e(values,)h(so)h
(the)g(list)g(of)g(columns)h(her)o(e)e(does)g(not)679
1530 y(need)20 b(to)h(include)g(every)f(column)i(in)f(the)g(table.)p
Black 596 1662 a Fb(\225)p Black 43 w Fi(SELECT)p Fg(:)16
b(this)i(is)g(the)f(most)h(compilicated)f(of)h(the)f(SQL)g(commands)h
(supported)f(by)g Fi(trivsql)p Fg(.)679 1754 y(An)h(example)h(is)g
Fd(SELECT)g(*)g(FROM)h(newtable)f(WHERE)g(cola)g(=)g('123';)p
Fg(.)e(Y)-8 b(ou)20 b(ar)o(e)e(not)h(r)o(equir)o(ed)679
1845 y(to)g(have)f(a)g(conditional)h(applied)f(to)h(the)g(select)f
(statement)h(--)f(so)h Fd(SELECT)f(*)h(FROM)g(newtable)679
1936 y Fg(will)g(r)o(eturn)e(all)i(the)f(r)o(ows)h(in)f(the)h(table.)f
(If)g(the)g(select)g(has)h(r)o(eturned)e(a)h(column)h(value)f(which)679
2028 y(has)28 b(a)f(NULL)g(value)h(\(i.e.)f(data)g(has)h(never)f(been)h
(inserted)g(ther)o(e\),)e(then)j(you'll)g(r)o(ecieve)d(a)679
2119 y(\(char)19 b(*\))i(NULL.)f(The)g(available)g(conditions)i(ar)o(e)
d(discussed)i(below)-8 b(.)p Black 596 2252 a Fb(\225)p
Black 43 w Fi(AL)i(TER)p Fg(:)15 b Fd(AL)-6 b(TER)16
b(newtable)h(ADD)f(COLUMN)g(cold;)g Fg(allows)h(you)g(to)g(add)e
(columns)j(to)f(a)f(table.)679 2343 y(At)k(the)h(moment)h(you)f(can)f
(only)i(add)e(columns)i(to)f(a)f(table)g(with)i(the)f
Fd(AL)-6 b(TER)20 b Fg(command.)p Black 596 2476 a Fb(\225)p
Black 43 w Fi(UPDA)-8 b(TE)p Fg(:)22 b(allows)i(commands)h(of)e(the)h
(form)f Fd(UPDA)-5 b(TE)23 b(newtable)h(SET)f(two)g(=)h('g')f(WHERE)679
2567 y(two)k(=)h('f)5 b(';)p Fg(.)28 b(This)g(is)h(useful)f(for)g
(changing)g(existing)h(values)f(in)g(a)g(r)o(ow)g(without)h(having)g
(to)679 2659 y(r)o(emove)20 b(the)h(entir)o(e)f(r)o(ow)g(and)h(then)g
(r)o(eadd)e(it.)197 3060 y Fh(The)29 b(current)g(state)f(of)h(pla)n(y)
596 3201 y Fg(As)18 b(shown)i(by)e(the)h(list)g(of)f(SQL)g(commands)h
(supported,)f Fi(trivsql)f Fg(is)i(by)f(no)h(means)g(a)f(complete)596
3293 y(SQL)j(implementation)i(at)e(this)h(time.)g(It)g(is)g(however)f
(quite)i(useful,)e(and)g(stable.)g(Because)g(it)h(is)596
3384 y(open)d(sour)o(ce,)e(it)i(is)g(also)g(possible)h(for)e(users)h
(to)g(add)e(support)i(for)g(their)g(own)g(SQL)f(commands)596
3475 y(if)i(they)h(ar)o(e)e(needed.)596 3608 y Fi(trivsql)14
b Fg(is)j(still)f(being)g(actively)g(developed)f(--)g(futur)o(e)f(r)o
(eleases)h(will)h(include)g(gr)o(eater)f(function-)596
3699 y(ality)-9 b(,)22 b(so)h(users)g(should)h(keep)e(track)g(of)h
(what)g(has)g(r)o(ecently)f(been)g(r)o(eleased)f(by)i(occassionally)596
3791 y(visiting)e(http://www)-8 b(.stillhq.com)197 4109
y Fh(Interface)29 b(to)f(trivsql)596 4250 y Fg(...)197
4568 y Fh(An)g(e)n(xample)g(usa)o(g)q(e)596 4710 y Fi(trivsql)22
b Fg(is)h(r)o(eally)g(easy)f(to)i(use.)f(The)g(code)g(snippet)h(below)f
(is)h(fr)o(om)f(the)g Fi(trivsql)f Fg(distribution.)596
4801 y(It)k(simply)i(r)o(eads)d(commands)i(fr)o(om)f(standar)o(d)f
(input,)i(and)f(executes)g(them)h(with)g Fi(trivsql)p
Fg(.)e(If)596 4893 y(the)h(command)g(r)o(eturned)f(a)g(r)o(ecor)o(dset)
f(\(which)j(is)f(how)h(all)f(data)f(is)h(r)o(eturned)f(to)h(the)g
(caller\),)596 4984 y(then)21 b(the)g(r)o(ecor)o(dset)e(is)i
(displayed.)596 5149 y Fe(#include)43 b Fa(<)p Fe(stdio.h)p
Fa(>)596 5231 y Fe(#include)g("trivsql.h")596 5396 y(int)h(main\(int)f
(argc,)h(char)g(*argv[]\){)685 5478 y(trivsql_state)f(*ourState;)p
Black 3642 5585 a Fd(5)p Black eop
%%Page: 6 6
6 5 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(trivsql_recordset)42 b(*rs;)685 171
y(char)i(cmd[1000];)685 336 y(if\(argc)g(!=)g(2\){)775
418 y(fprintf\(stderr,)e("Please)i(specify)f(a)i(db)g(file\\n"\);)775
500 y(exit\(42\);)685 582 y(})685 747 y(ourState)f(=)g
(trivsql_opendb\(argv[1]\);)685 829 y(if\(trivsql_initok\(ourState\))c
(!=)45 b(TRIVSQL_TRUE\){)775 911 y(fprintf\(stderr,)d("Database)h(open)
i(failed\\n"\);)775 993 y(exit\(42\);)685 1075 y(})685
1240 y(while\(fgets\(cmd,)d(1000,)i(stdin\))g(!=)h(NULL\){)775
1322 y(rs)f(=)h(trivsql_execute\(ourState,)c(cmd\);)775
1404 y(if\(rs)j(!=)g(NULL\))g(trivsql_displayrs\(rs\);)775
1486 y(else)g(printf\("NULL)f(recordset\\n"\);)775 1569
y(trivsql_xfree\(rs\);)685 1651 y(})596 1733 y(})596
1907 y Fd(Code:)20 b(/home/mikal/opensour)o(ce/trivsql/example.c)596
2159 y Fc(Input)596 2296 y Fg(The)g(following)j(input:)596
2461 y Fe(CREATE)43 b(TABLE)h(newtable)g(\(cola,)g(colb,)g(colc\);)596
2544 y(SELECT)f(*)i(FROM)f(newtable;)596 2626 y(INSERT)f(INTO)h
(newtable)g(\(cola,)g(colc\))g(VALUES)g(\('123',)f('banana'\);)596
2708 y(SELECT)g(*)i(FROM)f(newtable;)596 2790 y(SELECT)f(*)i(FROM)f
(newtable)g(WHERE)g(cola)g(=)g('123';)596 2965 y Fd(Code:)20
b(/home/mikal/opensour)o(ce/trivsql/example.sql)596 3097
y Fg(Pr)o(oduces)g(the)h(following)h(output:)197 3498
y Fh(Genstruct)29 b(as)f(an)g(alternative)596 3640 y
Fg(Given)e(that)h(the)f(Samba)g(team)g(chose)h(to)g(use)f
Fi(genstruct)f Fg(to)i(solve)g(this)g(same)f(pr)o(oblem,)g(it)h(is)596
3731 y(worthwhile)22 b(to)f(brie\003y)g(discuss)g(their)g(solution.)197
4049 y Fh(What)28 b(is)g(g)q(enstruct?)596 4191 y Fi(genstruct)d
Fg(is)j(very)f(similar)h(in)g(some)g(r)o(espects)f(to)h(the)f(perl)g
Fi(Data::Dumper)p Fg(.)e(It)j(is)g(ther)o(efor)o(e)596
4282 y(useful)c(to)h(pr)o(ovide)f(a)h(brief)f(intr)o(oduction)h(to)g
(that)g(functionality)h(befor)o(e)d(moving)j(onto)g Fi(gen-)596
4374 y(struct)p Fg(.)596 4626 y Fc(P)m(erl')-5 b(s)24
b(Data::Dumper)i(in)f(a)g(n)o(utshell)596 4763 y Fg(Perl's)20
b Fi(Data::Dumper)f Fg(is)i(quite)g(simple)g(to)h(use:)596
4895 y(Which)f(pr)o(oduces...)596 5061 y Fe($VAR1)44
b(=)g([)1044 5143 y('foo',)1044 5225 y('bar')954 5307
y(];)596 5389 y($VAR2)g(=)g({)1044 5472 y('walter')f(=>)i('wibble',)p
Black 197 5585 a Fd(6)p Black eop
%%Page: 7 7
7 6 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 1044 89 a Fe('carl')44 b(=>)g('chicken',)1044 171
y('bob')g(=>)g('banana')954 253 y(};)596 336 y($VAR3)g(=)g(42;)596
685 y Fc(Genstruct)596 822 y Fi(genstruct)21 b Fg(is)i(a)f(perl)g(pr)o
(ogram)g(which)i(is)f(r)o(un)g(at)f(compile)h(time.)g(It)g(parses)f
(the)h(c)f(header)g(\002les)596 913 y(for)29 b(the)i(pr)o(ogram)e(you)i
(want)f(to)h(use)f Fi(genstruct)f Fg(with,)i(using)g(tags)f(that)g(you)
h(have)f(to)g(em-)596 1005 y(bed)24 b(into)j(the)e(header)g(\002le.)g
(For)h(example,)e(the)i(sample)f(which)h(comes)g(with)h
Fi(genstruct)c Fg(is)j(as)596 1096 y(follows:)596 1261
y Fe(GENSTRUCT)43 b(enum)h(fruit)g({APPLE,)g(ORANGE=2,)f(PEAR,)954
1344 y(RASBERRY,)g(PEACH};)596 1508 y(GENSTRUCT)596 1590
y(struct)g(test2)596 1672 y({)640 1755 y(int)i(x1;)640
1837 y(char)g(*foo;)640 1919 y(char)g(fstring[20];)d(_NULLTERM)640
2001 y(int)j(dlen;)640 2083 y(char)g(*dfoo;)e(_LEN\(dlen\))640
2165 y(enum)i(fruit)e(fvalue;)640 2248 y(struct)h(test2)g(*next;)596
2330 y(};)596 2494 y(GENSTRUCT)f(struct)h(test1)g({)640
2576 y(char)h(foo[100];)640 2659 y(char)g(*foo2[20];)640
2741 y(int)g(xlen;)640 2823 y(int)g(*iarray;)e(_LEN\(xlen\);)640
2905 y(unsigned)h(slen;)640 2987 y(char)h(**strings;)e(_LEN\(slen\);)
640 3070 y(char)i(*s2[5];)640 3152 y(double)f(d1,)g(d2,)h(d3;)640
3234 y(struct)f(test2)g(*test2;)640 3316 y(int)h(alen;)640
3398 y(struct)f(test2)g(*test2_array;)f(_LEN\(alen\);)640
3481 y(struct)h(test2)g(*test2_fixed[2];)640 3563 y(int)h(plen;)640
3645 y(struct)f(test2)g(**test2_parray;)e(_LEN\(plen\))596
3727 y(};)596 3901 y Fd(Code:)20 b(../short-genstruct/article.sgml)596
4034 y Fg(In)31 b(this)h(example)f(you)h(can)f(see)g(that)g(str)o
(uctur)o(es)h(which)g(should)g(have)f Fi(genstruct)f
Fg(enabled)596 4126 y(have)k(the)i Fi(GENSTRUCT)f Fg(attribute)f
(associated)h(with)h(them,)f(you)h(ar)o(e)e(ther)o(efor)o(e)f(not)j(r)o
(e-)596 4217 y(quir)o(ed)27 b(to)i(have)f(all)h(of)f(the)h(data)e(str)o
(uctur)o(es)h(in)h(your)g(code)f(exportable.)f Fi(GENSTRUCT)i
Fg(is)596 4308 y(mer)o(ely)20 b(an)g(empty)h(#de\002ne,)f(which)i(the)f
Fi(genstruct)e Fg(header)g(\002le)i(parser)f(can)h(sear)o(ch)e(for)-6
b(.)596 4441 y(T)e(o)21 b(cr)o(eate)e(a)h(string)i(r)o(epr)o
(esentation)d(of)i(a)f(data)g(str)o(uctur)o(e,)g(simply:)596
4606 y Fe(char)44 b(*s;)596 4688 y(struct)f(test1)h(t;)596
4853 y(//)g(...)g(we)h(need)f(to)g(populate)g(t)h(with)f(data)g(here)g
(...)596 5017 y(s)g(=)h(gen_dump\(pinfo_test1,)c(\(char)j(*\))h(&t,)f
(0\);)596 5192 y Fg(In)19 b(this)i(code,)e(we)g(de\002ne)h(a)f(str)o
(uctur)o(e,)g(\002ll)h(it)g(with)g(data,)e(and)h(then)i(use)e(the)h
Fi(gen_dump)d Fg(func-)596 5283 y(tion)25 b(to)g(cr)o(eate)d(a)i
(string)i(r)o(epr)o(esentation)d(of)h(that)h(str)o(uctur)o(e.)f(The)g
(ar)o(guments)g(to)h Fi(gen_dump)596 5374 y Fg(ar)o(e:)p
Black 3642 5585 a Fd(7)p Black eop
%%Page: 8 8
8 7 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fe(char)44 b(*gen_dump\(const)e(struct)i(parse_struct)f
(*pinfo,)1268 171 y(const)h(char)g(*data,)1268 253 y(unsigned)f
(indent\);)p Black 596 594 a Fb(\225)p Black 43 w Fd(const)30
b(struct)h(parse_struct)g(*pinfo)p Fg(:)g(is)h(generated)e(at)g
(compile)i(time)f(by)h Fi(genstruct)p Fg(,)d(and)i(is)679
685 y(located)20 b(in)h(the)g(output)g(to)g(that)g(command.)p
Black 596 818 a Fb(\225)p Black 43 w Fd(const)i(char)g(*data)p
Fg(:)g(is)h(the)f(data)g(to)h(dump)g(to)g(the)f(string)i(r)o(epr)o
(esentation)d(\(simply)i(cast)g(your)679 909 y(str)o(uctur)o(e)c(to)h
(a)f(char)g(*)i(befor)o(e)d(passing)i(it.)p Black 596
1042 a Fb(\225)p Black 43 w Fd(unsigned)f(indent)p Fg(:)h(is)g(the)g
(starting)g(indent)g(for)g(ease)f(of)g(r)o(ecursive)g(calling.)h(Set)f
(it)h(to)g(zer)o(o.)p Black 596 1175 a Fb(\225)p Black
43 w Fi(Returns)p Fg(:)e(a)h(string)h(r)o(epr)o(esentation)f(of)h(the)g
(str)o(uctur)o(e.)596 1441 y(The)26 b(most)i(inter)o(esting)f(thing)g
(her)o(e)f(is)h(the)g Fd(pinfo)f Fg(str)o(uctur)o(e)g(which)i(is)f(the)
g(\002rst)f(ar)o(gument)h(to)596 1532 y(this)21 b Fi(gen_dump)e
Fg(function.)i(The)g Fd(pinfo_test1)e Fg(in)i(this)h(example)e(looks)i
(like:)596 1697 y Fe(static)43 b(const)h(struct)g(parse_struct)f
(pinfo_test1[])g(=)h({)596 1779 y({"foo",)f(0,)i(sizeof\(char\),)d
(offsetof\(struct)h(test1,)g(foo\),)h(100,)h(NULL,)685
1862 y(0,)g(gen_dump_char,)d(gen_parse_char},)596 1944
y({"foo2",)h(1,)h(sizeof\(char\),)f(offsetof\(struct)f(test1,)i
(foo2\),)g(20,)g(NULL,)685 2026 y(0,)h(gen_dump_char,)d
(gen_parse_char},)596 2108 y({"xlen",)h(0,)h(sizeof\(int\),)f
(offsetof\(struct)g(test1,)g(xlen\),)h(0,)h(NULL,)685
2190 y(0,)g(gen_dump_int,)d(gen_parse_int},)596 2273
y({"iarray",)h(1,)h(sizeof\(int\),)f(offsetof\(struct)f(test1,)i
(iarray\),)g(0,)685 2355 y("xlen",)g(0,)g(gen_dump_int,)f
(gen_parse_int},)596 2437 y(//)h(...)g(and)h(so)f(on)h(...)596
2519 y({NULL,)e(0,)i(0,)f(0,)h(0,)f(NULL,)g(0,)h(NULL,)f(NULL}};)596
2693 y Fg(This)34 b(table)f(might)h(seem)g(a)f(bit)h(daunting)f(at)h
(\002rst,)f(but)h(r)o(eaders)d(need)j(to)f(r)o(emember)g(that)596
2785 y(they'r)o(e)27 b(not)i(expected)e(to)i(be)e(able)h(to)h(r)o(ead,)
d(generate,)h(or)h(use)g(these)h(tables.)e(They)i(ar)o(e)d(cr)o(e-)596
2876 y(ated)19 b(solely)j(for)e(the)h(use)g(of)g Fi(genstruct)p
Fg(.)596 3009 y(The)f(output)h(of)g(the)g Fi(gen_dump)e
Fg(function)i(call)g(will)g(be)g(something)h(like:)596
3174 y Fe(foo)44 b(=)h({hello)e(foo})596 3256 y(foo2)h(=)g(1:{foo2)g
(\\7d)g(you},)g(2:{foo2)g(you)g(2})596 3339 y(xlen)g(=)g(6)596
3421 y(iarray)f(=)i(0:9,)f(1:4,)g(2:3,)g(3:9,)h(4:7)596
3503 y(slen)f(=)g(3)596 3585 y(strings)f(=)i(0:{test)e(string)h(48},)g
(1:{test)g(string)g(69},)g(2:{test)g(string)g(36})596
3667 y(s2)g(=)h(2:{t2)f(string)f(0},)i(3:{t2)f(string)g(74})596
3750 y(d1)g(=)h(3.5)596 3832 y(d3)f(=)h(-7)596 3914 y(test2)f(=)g({)954
3996 y(x1)h(=)f(4)954 4078 y(foo)g(=)h({hello)f(\\7b)g(there})954
4160 y(fstring)g(=)g({blah)g(1})954 4243 y(dlen)g(=)h(12)954
4325 y(dfoo)f(=)h({q\\a9\\08z\\faO\\ca\\e3\\1d\\b2M\\88})954
4407 y(fvalue)f(=)h(APPLE)954 4489 y(next)f(=)h({)1313
4571 y(x1)f(=)h(5)1313 4654 y(foo)f(=)h({hello)f(\\7b)g(there})1313
4736 y(fstring)f(=)i({blah)f(1})1313 4818 y(dlen)g(=)h(28)1313
4900 y(dfoo)f(=)h({\\e8\\8f\\dc\\1c\\0e\\c7\)'\\ea\\da\\07e\\ca\\04)o
(2\\ce\\0)o(78?\\b0)o(@\\ba\\a)o(b\\90\\8)o(4\\8e\\a)o(d6})1313
4982 y(fvalue)f(=)g(APPLE)1313 5065 y(next)g(=)h({)1671
5147 y(x1)g(=)g(6)1671 5229 y(foo)g(=)f({hello)g(\\7b)h(there})1671
5311 y(fstring)f(=)h({blah)f(1})1671 5393 y(dlen)h(=)f(27)1671
5476 y(dfoo)h(=)f({5r\\c3\\c4O\\e0\\d2\\16)266 b
(\\f9\\01\\e3\\01f\\ad\\05\\98\\7b^L\\d0\\bb\\bd\\11u)o(h\\a1\\f)o(9})p
Black 197 5585 a Fd(8)p Black eop
%%Page: 9 9
9 8 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 1671 89 a Fe(fvalue)44 b(=)h(APPLE)1671 171 y(next)g(=)f({)2030
253 y(x1)h(=)f(7)2030 336 y(foo)g(=)h({hello)f(\\7b)g(there})2030
418 y(fstring)g(=)g({blah)g(1})2030 500 y(dlen)g(=)h(14)2030
582 y(dfoo)f(=)h({N/\\d1\\83\\a2\\94G\\f1t\\1a\\07\\7d\\13\\08})2030
664 y(fvalue)f(=)h(APPLE)1671 747 y(})1313 829 y(})954
911 y(})596 993 y(})596 1168 y Fg(This)21 b(string)g(r)o(epr)o
(esentation)f(can)g(then)h(be)g(stor)o(ed)f(for)h(later)f(use.)197
1569 y Fh(The)29 b(other)g(side)f(of)g(the)h(equation)596
1710 y Fg(The)24 b(only)h(r)o(eason)f(you)g(would)h(use)f(a)g(package)f
(such)i(as)f Fi(Data::Dumper)e Fg(or)i Fi(genstruct)f
Fg(is)h(so)596 1801 y(that)19 b(you)h(can)g(r)o(ead)e(the)h
(information)i(back)e(in)h(later)-6 b(.)19 b(This)h(is)g(done)f(with)i
(the)f Fi(eval)e Fg(function)i(in)596 1893 y(perl.)e
Fi(genstruct)p Fg('s)f(equivalent)i(is)g Fi(gen_parse)p
Fg(,)d(which)k(takes)e(your)h(string)h(r)o(epr)o(esentation)d(and)596
1984 y(r)o(ecr)o(eates)h(the)j(data)e(str)o(uctur)o(es)i(as)f(stor)o
(ed.)g(The)h(ar)o(guments)f(to)h Fi(gen_parse)e Fg(ar)o(e:)596
2149 y Fe(int)44 b(gen_parse\(const)e(struct)i(parse_struct)f(*pinfo,)
1223 2232 y(char)h(*data,)1223 2314 y(const)g(char)g(*str0\);)p
Black 596 2654 a Fb(\225)p Black 43 w Fd(const)33 b(struct)h
(parse_struct)g(*pinfo)p Fg(:)g(is)g(the)g(same)g(parse)f(str)o(uctur)o
(e)h(that)g(was)g(used)f(in)i(the)679 2745 y Fi(gen_dump)18
b Fg(call.)p Black 596 2878 a Fb(\225)p Black 43 w Fd(char)24
b(*data)p Fg(:)g(is)h(a)f(pointer)i(to)f(the)g(location)h(that)e(the)i
(str)o(uctur)o(e)e(should)i(be)e(cr)o(eated)f(at.)h(This)679
2970 y(memory)d(should)h(alr)o(eady)c(have)j(been)f(allocated)g(\(for)g
(the)h(main)g(str)o(uctur)o(e\).)p Black 596 3102 a Fb(\225)p
Black 43 w Fd(const)f(char)g(*str0)p Fg(:)h(the)g(string)g(r)o(epr)o
(esentation)f(to)h(use.)p Black 596 3235 a Fb(\225)p
Black 43 w Fi(Returns)p Fg(:)e(non)i(zer)o(o)f(if)h(ther)o(e)f(was)g
(an)h(err)o(or)-6 b(.)596 3368 y(A)20 b(sample)g(usage)h(is:)596
3533 y Fe(char)44 b(*s;)596 3616 y(struct)f(test1)h(t1,)h(t2;)596
3780 y(//)f(...)g(we)h(need)f(to)g(populate)g(t1)g(with)h(data)f(here)g
(...)596 3944 y(s)g(=)h(gen_dump\(pinfo_test1,)c(\(char)j(*\))h(&t1,)f
(0\);)596 4026 y(memset\(&t2,)e(0,)j(sizeof\(t2\)\);)596
4191 y(if\(gen_parse\(pinfo_test1,)40 b(\(char)k(*\))h(&t2,)f(s\))g(!=)
h(0\){)685 4273 y(printf\("Parse)e(failed!\\n"\);)685
4355 y(exit\(1\);)685 4437 y(})197 4797 y Fh(Genstruct)29
b(pr)n(os)g(and)g(cons)596 4939 y Fg(Advantages)19 b(of)i(the)g(Samba)e
(solution)k(to)e(this)g(pr)o(oblem)g(ar)o(e:)p Black
712 5154 a(1.)p Black 20 w(Fewer)f(database)f(accesses)p
Black 712 5287 a(2.)p Black 20 w(MORE?)596 5420 y(However)-6
b(,)20 b(the)h(disadvantages)e(of)i(this)g(solution)i(ar)o(e:)p
Black 3642 5585 a Fd(9)p Black eop
%%Page: 10 10
10 9 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black Black 712 89 a Fg(1.)p Black 20 w(Requiring)i(pr)o(e)e(pr)o
(ocessing)h(of)f(sour)o(ce)h(code)f(with)i(a)e(perl)g(script)p
Black 712 222 a(2.)p Black 20 w(The)h(computational)g(ef)o(fort)e
(expended)h(in)h(data)f(serialization)p Black 712 355
a(3.)p Black 20 w(MORE?)197 673 y Fh(Conc)n(lusion)596
814 y Fg(This)28 b(paper)g(has)g(described)f Fi(trivsql)p
Fg(,)g(a)h(SQL)g(engine)h(which)g(can)f(be)g(embedded)f(into)j(your)596
906 y(code.)25 b(This)i(code)f(is)g(still)h(a)f(work)g(in)h(pr)o(ogr)o
(ess,)e(and)h(updates)f(on)i(it's)f(development)g(can)g(be)596
997 y(found)20 b(at)h(http://www)-8 b(.stillhq.com)197
1315 y Fh(Code)28 b(listings)596 1457 y Fg(All)20 b(the)h(code)g
(included)f(her)o(e)g(is)h(available)e(for)i(download)g(fr)o(om)f
(http://www)-8 b(.stillhq.com.)596 1709 y Fc(SQL)25 b(le)o(x)o(er)596
1846 y Fg(The)20 b(lexer)g(for)h(my)g(SQL)f(implementation)i(is:)596
2011 y Fe(\045{)596 2175 y(#include)43 b("parser.h")596
2340 y(#undef)g(YY_INPUT)596 2422 y(#define)g(YY_INPUT\(b,)g(r,)i(ms\))
f(\(r)g(=)h(trivsql_gettext\(b,)d(ms\)\))596 2504 y(\045})596
2668 y(\045\045)596 2833 y([Ss][Ee][Ll][Ee][Cc][Tt])847
b({)45 b(return)f(SELECT;)f(})596 2915 y([Cc][Rr][Ee][Aa][Tt][Ee])847
b({)45 b(return)f(CREATE;)f(})596 2997 y([Ii][Nn][Ss][Ee][Rr][Tt])847
b({)45 b(return)f(INSERT;)f(})596 3079 y([Vv][Aa][Ll][Uu][Ee][Ss])847
b({)45 b(return)f(VALUES;)f(})596 3161 y([Ii][Nn][Tt][Oo])1207
b({)45 b(return)f(INTO;)g(})596 3244 y([Tt][Aa][Bb][Ll][Ee])1027
b({)45 b(return)f(TABLE;)g(})596 3326 y([Ff][Rr][Oo][Mm])1207
b({)45 b(return)f(FROM;)g(})596 3408 y([Ww][Hh][Ee][Rr][Ee])1027
b({)45 b(return)f(WHERE;)g(})596 3490 y([Ll][Ii][Kk][Ee])1207
b({)45 b(return)f(LIKE;)g(})596 3572 y([Aa][Ll][Tt][Ee][Rr])1027
b({)45 b(return)f(ALTER;)g(})596 3655 y([Aa][Dd][Dd])1387
b({)45 b(return)f(ADD;)g(})596 3737 y([Cc][Oo][Ll][Uu][Mm][Nn])847
b({)45 b(return)f(COLUMN;)f(})596 3819 y([Uu][Pp][Dd][Aa][Tt][Ee])847
b({)45 b(return)f(UPDATE;)f(})596 3901 y([Ss][Ee][Tt])1387
b({)45 b(return)f(SET;)g(})596 3983 y([Aa][Nn][Dd])1387
b({)45 b(return)f(AND;)g(})596 4066 y([Oo][Rr])1567 b({)45
b(return)f(OR;)g(})596 4230 y([a-zA-Z0-9\045\\-]+)1252
b({)45 b(yylval)f(=)g(trivsql_xsnprintf\("\045s",)d(yy-)596
4312 y(text\);)i(return)h(STRING;)g(})596 4394 y([)g(\\t\\r\\n])1523
b({)45 b(})596 4477 y(.)1882 b({)45 b(return)f(yytext[0];)f(})596
4641 y(\045\045)596 4815 y Fd(Code:)20 b(/home/mikal/opensour)o
(ce/trivsql/lexer)-6 b(.l)596 4948 y Fg(I)22 b(am)h(not)g(completely)h
(happy)e(with)i(this)g(implementation.)f(My)g(main)g(objection)h(is)f
(the)g(way)596 5039 y(I)d(have)h(implemented)g(case)f(insensitivity)-9
b(,)22 b(although)f(I)g(am)g(not)g(awar)o(e)e(of)i(a)f(better)g
(method.)p Black 197 5585 a Fd(10)p Black eop
%%Page: 11 11
11 10 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fc(SQL)25 b(grammar)596 226 y Fg(The)20
b(grammar)g(for)h(my)g(SQL)f(implementation)i(is:)596
391 y Fe(\045{)685 556 y(#include)44 b Fa(<)p Fe(stdio.h)p
Fa(>)685 638 y Fe(#include)g("trivsql.h")685 802 y(#define)g
(YYERROR_VERBOSE)e(1)685 967 y(trivsql_state)h(*gState;)596
1049 y(\045})596 1213 y(\045token)g(CREATE)h(TABLE)596
1295 y(\045token)f(INSERT)h(VALUES)g(INTO)596 1378 y(\045token)f
(SELECT)h(FROM)g(STRING)g(WHERE)g(LIKE)596 1460 y(\045token)f(ALTER)h
(ADD)h(COLUMN)596 1542 y(\045token)e(UPDATE)h(SET)596
1624 y(\045token)f(AND)i(OR)596 1789 y(\045\045)596 1953
y(sql)268 b(:)45 b(create)e(sql)i(|)f(insert)g(sql)h(|)f(sel)h(sql)f(|)
h(alt)f(sql)g(|)h(upd)f(sql)999 2035 y(|)999 2117 y(;)596
2446 y(create)133 b(:)45 b(CREATE)e(TABLE)h(STRING)g('\(')h(colvalspec)
e('\)')h(';')596 2528 y({)g(gState-)p Fa(>)p Fe(rs)f(=)i
(trivsql_makers\(\(char)c(*\))k($3\);)f(trivsql_docreate\(\(char)d(*\))
k($3,)f(\(char)g(*\))g($5\);)h(})999 2610 y(;)596 2775
y(insert)133 b(:)45 b(INSERT)e(INTO)i(STRING)e('\(')i(colvalspec)e
('\)')h(VALUES)g('\(')g(colvalspec)g('\)')g(';')596 2857
y({)g(gState-)p Fa(>)p Fe(rs)f(=)i(trivsql_makers\(\(char)c(*\))k
($3\);)f(trivsql_checktable\(\(char)d(*\))j($3,)h(gState-)596
2939 y Fa(>)p Fe(rs\);)e(if\(gState-)p Fa(>)p Fe(rs-)p
Fa(>)p Fe(errno)f(==)i(TRIVSQL_FALSE\){trivsql_doinsert\(\(char)39
b(*\))44 b($3,)h(\(char)f(*\))g($5,)g(\(char)g(*\))h($9\);}})999
3021 y(;)596 3186 y(sel)268 b(:)45 b(SELECT)e(cvsaster)h(FROM)g(STRING)
g({)h(gState-)p Fa(>)p Fe(rs)e(=)h(trivsql_makers\(\(char)e(*\))i
($4\);)g(trivsql_xfree\(gState-)596 3268 y Fa(>)p Fe(table\);)f
(gState-)p Fa(>)p Fe(table)f(=)j(trivsql_xsnprintf\("\045s",)c($4\);)j
(})h(wsel)f(';')596 3350 y({)g(trivsql_checktable\(\(char)d(*\))j($4,)h
(gState-)p Fa(>)p Fe(rs\);)e(if\(gState-)p Fa(>)p Fe(rs-)p
Fa(>)p Fe(errno)e(==)j(TRIVSQL_FALSE\){trivsql_doselect\(\(char)39
b(*\))44 b($4,)h(\(char)f(*\))g($2\);}})999 3432 y(;)596
3597 y(alt)268 b(:)45 b(ALTER)f(STRING)f(ADD)i(COLUMN)f(STRING)f(';')
596 3679 y({)h(gState-)p Fa(>)p Fe(rs)f(=)i(trivsql_makers\(\(char)c
(*\))k($2\);)f(trivsql_checktable\(\(char)d(*\))j($2,)h(gState-)596
3761 y Fa(>)p Fe(rs\);)e(if\(gState-)p Fa(>)p Fe(rs-)p
Fa(>)p Fe(errno)f(==)i(TRIVSQL_FALSE\){trivsql_doalter\(\(char)39
b(*\))44 b($2,)h(\(char)f(*\))g($5\);}})999 3843 y(;)596
4008 y(upd)268 b(:)45 b(UPDATE)e(STRING)h(SET)h(STRING)e('=')i(str)f({)
h(gState-)p Fa(>)p Fe(rs)e(=)h(trivsql_makers\(\(char)e(*\))i($2\);)h
(trivsql_xfree\(gState-)596 4090 y Fa(>)p Fe(table\);)e(gState-)p
Fa(>)p Fe(table)f(=)j(trivsql_xsnprintf\("\045s",)c($2\);)j(})h(wsel)f
(';')596 4172 y({trivsql_checktable\(\(char)c(*\))45
b($2,)f(gState-)p Fa(>)p Fe(rs\);)f(if\(gState-)p Fa(>)p
Fe(rs-)p Fa(>)p Fe(errno)e(==)j
(TRIVSQL_FALSE\){trivsql_doselect\(\(char)39 b(*\))45
b($2,)f(\(char)g(*\))g($4\);)h(trivsql_updaters\(gState,)40
b(gState-)596 4254 y Fa(>)p Fe(rs,)k(\(char)g(*\))g($4,)g(\(char)g(*\))
h($6\);}})999 4336 y(;)596 4665 y(cvsaster)e(:)i(colvalspec)e({)h($$)h
(=)g(trivsql_xsnprintf\("\045s",)c(\(char)j(*\))g($1\);)g(})999
4747 y(|)h('*')f({)h($$)f(=)h(trivsql_xsnprintf\("*"\);)c(})999
4830 y(;)596 4994 y(colvalspec)i(:)h(str)h(',')f(colvalspec)f({)i($$)f
(=)h(trivsql_xsnprintf\("\045s;\045s",)40 b(\(char)k(*\))h($1,)f
(\(char)g(*\))h($3\);)f(})999 5076 y(|)h(str)f({)h($$)f(=)h
(trivsql_xsnprintf\("\045s",)c(\(char)j(*\))g($1\);)g(})999
5158 y(;)596 5323 y(wsel)223 b(:)45 b(WHERE)f(selector)f({)i(gState-)p
Fa(>)p Fe(seltree)d(=)j($2;)f(})999 5405 y(|)p Black
3601 5585 a Fd(11)p Black eop
%%Page: 12 12
12 11 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 999 89 a Fe(;)596 253 y(selector)43 b(:)i(str)f('=')g(str)h({)f
($$)h(=)f(trivsql_makesel\(trivsql_selequal,)c($1,)k($3\);)g(})999
336 y(|)h(str)f(LIKE)g(str)g({)h($$)g(=)f
(trivsql_makesel\(trivsql_sellike,)c($1,)k($3\);)g(})999
418 y(|)h(selector)e(AND)h(selector)g({)h($$)f(=)h
(trivsql_makeslr\(trivsql_seland,)39 b($1,)45 b($3\);)f(})999
500 y(|)h(selector)e(OR)i(selector)e({)i($$)f(=)h
(trivsql_makeslr\(trivsql_seland,)40 b($1,)k($3\);)g(})999
582 y(|)h('\(')f(selector)f('\)')i({)f($$)h(=)g($2;)f(})685
664 y(|)h({)g($$)f(=)h(NULL;)f(})999 747 y(;)596 911
y(str)268 b(:)45 b(STRING)e({)i($$)g(=)f($1;)h(})999
993 y(|)g('\\\224)f(STRING)g('\\\224)g({)h($$)f(=)h($2;)f(})999
1075 y(;)596 1240 y(\045\045)596 1404 y(int)g(yyerror\(char)f(*s\){)685
1486 y(printf\("\\nsql)g(parsing)g(error:)h(\045s\\n",)g(s\);)685
1569 y(exit\(42\);)596 1651 y(})596 1825 y Fd(Code:)20
b(/home/mikal/opensour)o(ce/trivsql/parser)-6 b(.y)596
2133 y Fc(A)m(utomake)25 b(Make\002le)r(.am)596 2270
y Fg(The)g(following)h(\002le)g(is)f(used)g(to)g(automatically)g
(generate)g(a)f(Make\002le,)g(in)i(conjunction)h(with)596
2361 y Fi(autoconf)p Fg(.)596 2527 y Fe(lib_LTLIBRARIES)42
b(=)i(libtrivsql.la)596 2609 y(noinst_PROGRAMS)e(=)i(sample)596
2773 y(libtrivsql_la_SOURCES)d(=)j(parser.y)g(lexer.l)g(tdb.c)g
(spinlock.c)f(selectors.c)g(in-)596 2855 y(terface.c)g(internal.c)596
3020 y(include_HEADERS)f(=)i(trivsql.h)g(trivsql_tdb.h)e
(trivsql_spinlock.h)596 3184 y(sample_SOURCES)g(=)j(example.c)596
3266 y(sample_LDADD)d(=)j(-ltrivsql)e(-L.libs)596 3431
y(YFLAGS)g(=)i(-d)596 3605 y Fd(Code:)20 b(/home/mikal/opensour)o
(ce/trivsql/Make\002le.am)596 3913 y Fc(A)m(utoconf)25
b(con\002gure)r(.in)596 4050 y Fg(The)30 b(following)j(\002le)e(is)g
(used)g(to)g(automatically)g(generate)f(a)g(con\002gur)o(e)h(script,)f
(which)i(will)596 4141 y(build)20 b(a)h(Make\002le)e(appr)o(opriate)g
(to)i(the)g(build)g(host.)596 4307 y Fe(dnl)44 b(Process)f(this)i(file)
f(with)g(autoconf)f(to)i(produce)f(a)g(configure)g(script.)596
4389 y(AC_INIT\(lexer.l\))596 4471 y(AC_CONFIG_AUX_DIR\(config\))596
4553 y(AC_REVISION)596 4635 y(AM_INIT_AUTOMAKE\(trivsql,)c(0.4.1\))596
4718 y(AM_MAINTAINER_MODE)596 4882 y(dnl)k(Libtool)596
4964 y(AC_LIBTOOL_WIN32_DLL)596 5046 y(AC_LIBTOOL_DLOPEN)596
5211 y(dnl)g(Checks)g(for)g(programs.)596 5293 y(AC_PROG_CC)596
5375 y(AM_PROG_LEX)596 5457 y(AC_PROG_YACC)p Black 197
5585 a Fd(12)p Black eop
%%Page: 13 13
13 12 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fe(AC_PROG_INSTALL)596 171 y(AC_PROG_RANLIB)596
253 y(AM_PROG_LIBTOOL)596 418 y(dnl)44 b(Checks)g(for)g(libraries.)596
500 y(dnl)g(The)g(syntax)g(is)g(library)g(name,)g(function,)f(action)h
(if)h(found,)f(action)f(if)i(not)f(found)596 582 y(dnl)g(We)g(just)g
(use)h(the)f(default)g(if)g(found)g(action)g(which)g(adds)g(-l)p
Fa(<)p Fe(lib)p Fa(>)g Fe(to)g(the)h(LIBS)f(var)596 664
y(dnl)g(and)g(#defined)g(HAVE_LIB)p Fa(<)p Fe(lib)p Fa(>)596
911 y Fe(dnl)g(-lm:)596 993 y(AC_CHECK_LIB\(m,)e(atan\))596
1158 y(dnl)i(-lfl:)596 1240 y(AC_CHECK_LIB\(fl,)e(yywrap\))596
1404 y(dnl)i(Checks)g(for)g(header)g(files.)596 1486
y(dnl)g(STDC)g(checks)g(for)g(stdlib.h)g(stdarg.h)f(string.h)h(and)g
(float.h)596 1569 y(AC_HEADER_STDC)596 1733 y(dnl)g(Checks)g(for)g
(typedefs,)f(structures,)g(and)i(compiler)e(characteristics.)596
1897 y(dnl)h(Checks)g(for)g(library)g(functions.)596
2062 y(AC_OUTPUT\(Makefile\))596 2483 y Fd(Code:)20 b
(/home/mikal/opensour)o(ce/trivsql/con\002gur)o(e.in)596
2791 y Fc(C)25 b(sour)n(ce)f(code)596 2928 y Fg(The)c(following)j
(\002les)e(implement)g Fi(trivsql)f Fg(and)g Fi(tdb)p
Fg(...)596 3093 y Fe(#include)43 b("trivsql_tdb.h")596
3175 y(#include)g("trivsql_spinlock.h")596 3339 y(#ifndef)g
(TRIVSQL_HEADER)596 3422 y(#define)g(TRIVSQL_HEADER)596
3586 y(#ifdef)g(__cplusplus)596 3668 y(extern)g("C")596
3750 y({)596 3833 y(#endif)596 3997 y(#define)g(TRIVSQL_FALSE)g(0)596
4079 y(#define)g(TRIVSQL_TRUE)g(1)596 4244 y(#define)g
(TRIVSQL_NOSUCHTABLE)f(2)596 4326 y(#define)h(TRIVSQL_BADVALUES)f(3)596
4408 y(#define)h(TRIVSQL_MEMORYERROR)f(4)596 4490 y(#define)h
(TRIVSQL_TDBNULLKEY)f(5)596 4572 y(#define)h(TRIVSQL_TDBNULLDATA)f(6)
596 4654 y(#define)h(TRIVSQL_TDBSTOREERROR)e(7)596 4737
y(#define)i(TRIVSQL_NOSUCHCOLUMN)f(8)596 4819 y(#define)h
(TRIVSQL_NOROWSTOUPDATE)e(9)596 4901 y(#define)i(TRIVSQL_BADSELCOLARG)f
(10)596 4983 y(#define)h(TRIVSQL_DBOPENFAIL)f(11)596
5148 y(#define)h(SELTRUE)h(1)596 5230 y(#define)f(SELFALSE)h(0)596
5394 y(typedef)f(int)h(\(*trivsql_selectorfunc\))d(\(char)j(*arg1,)g
(char)g(*arg2\);)p Black 3601 5585 a Fd(13)p Black eop
%%Page: 14 14
14 13 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fe(typedef)43 b(struct)h(trivsql_internal_seltreenode)
596 171 y({)685 253 y(char)g(*selArgOne;)685 336 y(int)h(selColOne;)685
418 y(char)f(*selArgTwo;)685 500 y(int)h(selColTwo;)685
582 y(trivsql_selectorfunc)d(selector;)685 664 y(struct)i
(trivsql_internal_seltreenode)c(*left,)k(*right;)596
747 y(})g(trivsql_seltreenode;)596 911 y(typedef)f(struct)h
(trivsql_internal_col)596 993 y({)685 1075 y(char)g(*val;)685
1158 y(char)g(*key;)685 1240 y(struct)g(trivsql_internal_col)d(*next;)
596 1322 y(})j(trivsql_col;)596 1486 y(typedef)f(struct)h
(trivsql_internal_row)596 1569 y({)685 1651 y(trivsql_col)f(*cols;)685
1733 y(struct)h(trivsql_internal_row)d(*next,)j(*prev;)596
1815 y(})g(trivsql_row;)596 1979 y(typedef)f(struct)h
(trivsql_internal_rs)596 2062 y({)685 2144 y(int)h(numCols;)685
2226 y(int)g(numRows;)685 2308 y(trivsql_row)e(*rows;)685
2390 y(trivsql_row)g(*currentRow;)685 2555 y(char)h(*tname;)685
2637 y(char)g(*cols;)685 2801 y(int)h(errno;)685 2884
y(char)f(*errstring;)596 2966 y(})g(trivsql_recordset;)596
3130 y(typedef)f(struct)h(trivsql_internal_state)596
3212 y({)685 3295 y(TDB_CONTEXT)f(*db;)685 3377 y(trivsql_recordset)f
(*rs;)685 3459 y(trivsql_seltreenode)g(*seltree;)685
3541 y(char)i(*table;)596 3623 y(})g(trivsql_state;)596
3788 y(//)g(Internal)f(functions)596 3870 y(trivsql_state)f
(*trivsql_init\(char)g(*\);)596 3952 y(void)i(trivsql_docreate\(char)d
(*,)j(char)h(*\);)596 4034 y(void)f(trivsql_doinsert\(char)d(*,)j(char)
h(*,)f(char)g(*\);)596 4116 y(void)g(trivsql_doselect\(char)d(*,)j
(char)h(*\);)596 4199 y(void)f(trivsql_doalter\(char)d(*,)k(char)f
(*\);)596 4363 y(int)g(*trivsql_parsecols\(char)d(*,)j(char)g(*,)h(int)
f(*\);)596 4445 y(int)g(trivsql_findcol\(char)d(*,)k(char)f(*,)g(char)h
(*\);)596 4527 y(void)f(trivsql_addrow\(trivsql_recordset)39
b(*,)45 b(char)f(*,)g(int,)g(int)h(*\);)596 4610 y(char)f
(*trivsql_getallcolumns\(char)c(*\);)596 4692 y(trivsql_recordset)h
(*trivsql_makers\(\);)596 4774 y(trivsql_seltreenode)g
(*trivsql_makest\(\);)596 4856 y(trivsql_seltreenode*)g
(trivsql_makesel\(trivsql_selectorfunc,)e(char)44 b(*,)g(char)g(*\);)
596 4938 y(trivsql_seltreenode*)d
(trivsql_makeslr\(trivsql_selectorfunc,)999 5021 y(trivsql_seltreenode)
h(*,)999 5103 y(trivsql_seltreenode)g(*\);)596 5185 y(int)i
(trivsql_executeselector\(trivsql_seltre)o(enode)38 b(*,)45
b(int\);)596 5349 y(void)f(trivsql_checktable\(char)d(*,)j
(trivsql_recordset)e(*\);)p Black 197 5585 a Fd(14)p
Black eop
%%Page: 15 15
15 14 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fe(void)44 b(*trivsql_xmalloc\(size_t\);)596
171 y(void)g(trivsql_dbwrite\(trivsql_state)c(*,)k(char)g(*,)h(char)f
(*\);)596 253 y(char)g(*trivsql_dbread\(trivsql_state)c(*,)k(char)g
(*\);)596 336 y(char)g(*trivsql_xsnprintf\(char)d(*,)j(...\);)596
418 y(void)g(trivsql_xfree\(void)d(*\);)596 500 y(void)j
(*trivsql_xrealloc\(void)d(*,)j(size_t\);)596 582 y(int)g
(trivsql_min\(int,)e(int\);)596 664 y(int)i
(trivsql_initok\(trivsql_state)c(*\);)596 829 y(//)k(Selectors)596
911 y(int)g(trivsql_selequal\(char)d(*,)k(char)f(*\);)596
993 y(int)g(trivsql_sellike\(char)d(*,)k(char)f(*\);)596
1075 y(int)g(trivsql_selor\(int,)e(int\);)596 1158 y(int)i
(trivsql_seland\(int,)d(int\);)596 1322 y(//)j(Interface)f(methods)596
1404 y(trivsql_state)f(*trivsql_opendb\(char)g(*\);)596
1486 y(trivsql_recordset)f(*trivsql_execute\(trivsql_state)f(*,)45
b(char)f(*\);)596 1569 y(int)g(trivsql_gettext\(char)d(*,)k(int\);)596
1651 y(void)f(trivsql_displayrs\(trivsql_recordset)39
b(*\);)596 1733 y(void)44 b(trivsql_rsmovefirst\(trivsql_recordset)38
b(*\);)596 1815 y(void)44 b(trivsql_rsmovenext\(trivsql_recordset)38
b(*\);)596 1897 y(int)44 b(trivsql_rseof\(trivsql_recordset)39
b(*\);)596 1979 y(int)44 b(trivsql_rsbof\(trivsql_recordset)39
b(*\);)596 2062 y(char)44 b(*trivsql_rsfield\(trivsql_recordset)39
b(*,)44 b(int\);)596 2144 y(void)g(trivsql_updaters\(trivsql_state)39
b(*,)45 b(trivsql_recordset)d(*,)i(char)h(*,)f(char)g(*\);)596
2226 y(void)g(trivsql_rsupdatefield\(trivsql_state)39
b(*,)44 b(trivsql_recordset)e(*,)865 2308 y(int,)i(char)g(*newval\);)
596 2473 y(#ifdef)f(__cplusplus)596 2555 y(})596 2637
y(#endif)596 2801 y(#endif)596 2976 y Fd(Code:)20 b
(/home/mikal/opensour)o(ce/trivsql/trivsql.h)596 3141
y Fe(#include)43 b("trivsql.h")596 3305 y(char)h(*gTrivData)f(=)h
(NULL;)596 3388 y(int)g(gTrivInset;)596 3552 y(extern)f(trivsql_state)g
(*gState;)596 3716 y(//)h(Interface)f(to)i(the)f(SQL)g(database)596
3799 y(trivsql_state)e(*trivsql_opendb\(char)g(*path\){)685
3881 y(return)i(trivsql_init\(path\);)596 3963 y(})596
4127 y(trivsql_recordset)d(*trivsql_execute\(trivsql_state)f(*state,)k
(char)g(*sql\){)685 4209 y(trivsql_xfree\(gTrivData\);)685
4292 y(gTrivData)f(=)i(trivsql_xsnprintf\("\045s",)c(sql\);)685
4374 y(gTrivInset)i(=)i(0;)685 4538 y(trivsql_xfree\(state-)p
Fa(>)p Fe(rs\);)685 4620 y(state-)p Fa(>)p Fe(rs)e(=)i(NULL;)685
4703 y(gState)f(=)h(state;)685 4785 y(yyparse\(\);)685
4867 y(return)f(gState-)p Fa(>)p Fe(rs;)596 4949 y(})596
5114 y(int)g(trivsql_gettext\(char)d(*buffer,)j(int)g(maxlen\){)685
5196 y(int)h(size;)685 5360 y(//)g(Determine)e(the)h(maximum)g(size)g
(to)h(return)685 5442 y(size)f(=)h(trivsql_min\(maxlen,)d
(strlen\(gTrivData\))g(-)i(gTrivInset\);)p Black 3601
5585 a Fd(15)p Black eop
%%Page: 16 16
16 15 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 171 a Fe(if\(size)44 b Fa(>)g Fe(0\){)775 253
y(memcpy\(buffer,)e(gTrivData)i(+)g(gTrivInset,)f(size\);)775
336 y(gTrivInset)g(+=)h(size;)685 418 y(})685 582 y(return)g(size;)596
664 y(})596 829 y(void)g(trivsql_displayrs\(trivsql_recordset)39
b(*rs\){)685 911 y(int)45 b(i,)f(col;)685 993 y(char)g(*t,)h(*u,)f(*c,)
g(*localCols;)685 1158 y(//)h(Was)f(there)g(an)g(error?)685
1240 y(switch\(rs-)p Fa(>)p Fe(errno\){)685 1322 y(case)g
(TRIVSQL_FALSE:)775 1404 y(printf\("This)f(statement)g(produced)g(no)i
(results.\\n"\);)775 1486 y(return;)685 1651 y(case)f(TRIVSQL_TRUE:)775
1733 y(break;)685 1897 y(default:)775 1979 y(printf\("There)e(was)j(an)
f(error)g(processing)f(this)i(statement)e(\(\045d\).\\n",)775
2062 y(rs-)p Fa(>)p Fe(errno\);)775 2144 y(if\(rs-)p
Fa(>)p Fe(errstring)f(!=)i(NULL\))865 2226 y(printf\("trivsql)e(engine)
i(reported:)f(\045s\\n",)h(rs-)p Fa(>)p Fe(errstring\);)775
2308 y(return;)685 2390 y(})685 2555 y(//)h(Print)f(the)g(header)g
(line)685 2637 y(printf\("\\n="\);)685 2719 y(for\(i)g(=)h(0;)f(i)h
Fa(<)g Fe(rs-)p Fa(>)p Fe(numCols;)d(i++\){)775 2801
y(printf\("==============="\);)685 2884 y(})685 2966
y(printf\("\\n|"\);)685 3130 y(//)j(Print)f(out)g(the)g(column)g(names)
685 3212 y(localCols)f(=)i(trivsql_xsnprintf\("\045s",)c(rs-)p
Fa(>)p Fe(cols\);)685 3295 y(c)k(=)g(strtok\(localCols,)c(";"\);)685
3377 y(while\(c)j(!=)g(NULL\){)775 3459 y(printf\(")f(\045-12s)h(|",)h
(c\);)775 3541 y(c)g(=)f(strtok\(NULL,)f(";"\);)685 3623
y(})685 3788 y(printf\("\\n="\);)685 3870 y(for\(i)h(=)h(0;)f(i)h
Fa(<)g Fe(rs-)p Fa(>)p Fe(numCols;)d(i++\){)775 3952
y(printf\("==============="\);)685 4034 y(})685 4116
y(printf\("\\n"\);)685 4281 y(//)j(Print)f(out)g(the)g(values)g(we)h
(have)f(found)685 4363 y(trivsql_rsmovefirst\(rs\);)685
4445 y(while\(trivsql_rseof\(rs\))d(!=)k(TRIVSQL_TRUE\){)775
4527 y(for\(i)f(=)g(0;)h(i)g Fa(<)f Fe(rs-)p Fa(>)p Fe(numCols;)f
(i++\))865 4610 y(printf\("|)g(\045-12s)h(",)g(trivsql_rsfield\(rs,)e
(i\)\);)775 4692 y(printf\("|\\n-"\);)775 4774 y(for\(i)i(=)g(0;)h(i)g
Fa(<)f Fe(rs-)p Fa(>)p Fe(numCols;)f(i++\){)865 4856
y(printf\("---------------"\);)775 4938 y(})775 5021
y(printf\("\\n"\);)775 5185 y(trivsql_rsmovenext\(rs\);)685
5267 y(})685 5432 y(printf\("\\n"\);)p Black 197 5585
a Fd(16)p Black eop
%%Page: 17 17
17 16 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(printf\("Select)43 b(returned)g(\045d)i(rows)f(of)g
(\045d)h(columns\\n",)685 171 y(rs-)p Fa(>)p Fe(numRows,)e(rs-)p
Fa(>)p Fe(numCols\);)596 253 y(})596 418 y(void)h
(trivsql_rsmovefirst\(trivsql_recordset)38 b(*rs\){)685
500 y(rs-)p Fa(>)p Fe(currentRow)43 b(=)h(rs-)p Fa(>)p
Fe(rows;)596 582 y(})596 747 y(void)g
(trivsql_rsmovenext\(trivsql_recordset)38 b(*rs\){)685
829 y(if\(rs-)p Fa(>)p Fe(currentRow-)p Fa(>)p Fe(next)j(!=)j(NULL\))
775 911 y(rs-)p Fa(>)p Fe(currentRow)e(=)j(rs-)p Fa(>)p
Fe(currentRow-)p Fa(>)p Fe(next;)596 993 y(})596 1158
y(int)f(trivsql_rseof\(trivsql_recordset)39 b(*rs\){)685
1240 y(if\(rs-)p Fa(>)p Fe(errno)k(!=)h(TRIVSQL_TRUE\))f(return)h
(TRIVSQL_TRUE;)685 1322 y(return)g(rs-)p Fa(>)p Fe(currentRow-)p
Fa(>)p Fe(next)d(==)k(NULL)f(?)h(TRIVSQL_TRUE)d(:)j(TRIVSQL_FALSE;)596
1404 y(})596 1569 y(int)f(trivsql_rsbof\(trivsql_recordset)39
b(*rs\){)685 1651 y(return)44 b(rs-)p Fa(>)p Fe(currentRow)e(==)j(rs-)p
Fa(>)p Fe(rows)e(?)i(TRIVSQL_TRUE)e(:)h(TRIVSQL_FALSE;)596
1733 y(})596 1897 y(char)g(*trivsql_rsfield\(trivsql_recordset)39
b(*rs,)44 b(int)g(colnum\){)685 1979 y(int)h(count;)685
2062 y(trivsql_col)e(*theCol;)685 2226 y(count)h(=)h(0;)685
2308 y(theCol)f(=)h(rs-)p Fa(>)p Fe(currentRow-)p Fa(>)p
Fe(cols;)685 2390 y(while\(\(theCol-)p Fa(>)p Fe(next)d(!=)i(NULL\))g
(&&)h(\(count)f Fa(<)g Fe(colnum\)\){)775 2473 y(theCol)g(=)g(theCol-)p
Fa(>)p Fe(next;)775 2555 y(count++;)685 2637 y(})685
2801 y(return)g(theCol-)p Fa(>)p Fe(val;)596 2884 y(})596
3048 y(void)g(trivsql_updaters\(trivsql_state)39 b(*state,)44
b(trivsql_recordset)e(*rs,)954 3130 y(char)i(*col,)g(char)g(*newval\){)
685 3212 y(//)h(Was)f(there)g(an)g(error?)685 3295 y(switch\(rs-)p
Fa(>)p Fe(errno\){)685 3377 y(case)g(TRIVSQL_FALSE:)775
3459 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)e(=)i
(TRIVSQL_NOROWSTOUPDATE;)775 3541 y(return;)685 3706
y(case)g(TRIVSQL_TRUE:)775 3788 y(break;)685 3952 y(default:)775
4034 y(return;)685 4116 y(})685 4281 y(//)h(For)f(the)g(moment)g(we)h
(assume)e(there)h(is)h(only)f(one)g(column)685 4363 y
(trivsql_rsmovefirst\(rs\);)685 4445 y(while\(trivsql_rseof\(rs\))d(!=)
k(TRIVSQL_TRUE\){)775 4527 y(trivsql_rsupdatefield\(state,)40
b(rs,)k(0,)h(newval\);)775 4610 y(trivsql_rsmovenext\(rs\);)685
4692 y(})596 4774 y(})596 4938 y(//)f(NOTE:)g(The)g(existing)g
(recordset)f(is)i(not)f(updated)g(--)g(you)g(need)h(to)f(reselect)596
5021 y(void)g(trivsql_rsupdatefield\(trivsql_state)39
b(*state,)k(trivsql_recordset)f(*rs,)865 5103 y(int)i(colnum,)f(char)i
(*newval\){)685 5185 y(int)g(count;)685 5267 y(trivsql_col)e(*theCol;)
685 5432 y(count)h(=)h(0;)p Black 3601 5585 a Fd(17)p
Black eop
%%Page: 18 18
18 17 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(theCol)44 b(=)h(rs-)p Fa(>)p Fe(currentRow-)p
Fa(>)p Fe(cols;)685 171 y(while\(\(theCol-)p Fa(>)p Fe(next)d(!=)i
(NULL\))g(&&)h(\(count)f Fa(<)g Fe(colnum\)\){)775 253
y(theCol)g(=)g(theCol-)p Fa(>)p Fe(next;)775 336 y(count++;)685
418 y(})685 582 y(trivsql_dbwrite\(state,)d(theCol-)p
Fa(>)p Fe(key,)i(newval\);)596 664 y(})596 839 y Fd(Code:)20
b(/home/mikal/opensour)o(ce/trivsql/interface.c)596 1004
y Fe(#include)43 b("trivsql.h")596 1086 y(#include)g
Fa(<)p Fe(stdarg.h)p Fa(>)596 1251 y Fe(extern)g(trivsql_state)g
(*gState;)596 1333 y(const)h(char)g(*trivsql_version)e(=)i(VERSION;)596
1497 y(trivsql_state)e(*trivsql_init\(char)g(*filename\){)685
1579 y(trivsql_state)h(*state;)685 1744 y(state)h(=)h(\(trivsql_state)d
(*\))j(trivsql_xmalloc\(sizeof\(trivsql_state\)\))o(;)685
1826 y(state-)p Fa(>)p Fe(db)e(=)i(tdb_open\(filename,)d(0,)i(0,)h
(O_RDWR)f(|)g(O_CREAT,)g(0600\);)685 1908 y(state-)p
Fa(>)p Fe(rs)f(=)i(NULL;)685 1990 y(state-)p Fa(>)p Fe(seltree)e(=)h
(NULL;)685 2072 y(state-)p Fa(>)p Fe(table)f(=)i(NULL;)685
2237 y(//)g(We)f(write)g(the)g(version)g(of)h(trivsql)e(we)i(used)f
(into)g(a)h(tag)f(in)h(the)f(tdb)g(for)685 2319 y(//)h(debugging)685
2401 y(if\(state-)p Fa(>)p Fe(db)e(!=)h(NULL\))775 2483
y(trivsql_dbwrite\(state,)d("trivsql_lastversion",)g
(trivsql_version\);)685 2648 y(return)j(state;)596 2730
y(})596 2894 y(void)g(trivsql_docreate\(char)d(*tname,)j(char)g
(*cols\))596 2977 y({)685 3059 y(char)g(*t;)685 3141
y(char)g(*u;)685 3223 y(int)h(colCount)e(=)i(0;)685 3388
y(t)g(=)g(trivsql_xsnprintf\("trivsql_\045s_numrow)o(s",)39
b(tname\);)685 3470 y(trivsql_dbwrite\(gState,)i(t,)k("0"\);)685
3552 y(trivsql_xfree\(t\);)685 3716 y(u)g(=)g(strtok\(cols,)d(";"\);)
685 3799 y(while\(u)i(!=)g(NULL\){)775 3881 y(t)h(=)f
(trivsql_xsnprintf\("trivsql_\045s_col\045d",)39 b(tname,)44
b(colCount\);)775 3963 y(trivsql_dbwrite\(gState,)d(t,)j(u\);)775
4045 y(trivsql_xfree\(t\);)775 4209 y(colCount++;)775
4292 y(u)h(=)f(strtok\(NULL,)f(";"\);)685 4374 y(})685
4538 y(t)i(=)g(trivsql_xsnprintf\("trivsql_\045s_numcol)o(s",)39
b(tname\);)685 4620 y(u)45 b(=)g(trivsql_xsnprintf\("\045d",)40
b(colCount\);)685 4703 y(trivsql_dbwrite\(gState,)h(t,)k(u\);)685
4785 y(trivsql_xfree\(t\);)685 4867 y(trivsql_xfree\(u\);)596
4949 y(})596 5114 y(void)f(trivsql_doinsert\(char)d(*tname,)j(char)g
(*cols,)g(char)g(*vals\){)685 5196 y(char)g(*t,)h(*u,)f(*c;)685
5278 y(int)h(rowCount,)e(i,)h(col,)g(numCols;)685 5360
y(int)h(*colNumbers;)p Black 197 5585 a Fd(18)p Black
eop
%%Page: 19 19
19 18 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(if\(\(rowCount)43 b(=)i
(trivsql_getrowcount\(tname\)\))40 b(==)k(-1\){)775 171
y(return;)685 253 y(})685 418 y(//)h(Get)f(ready)g(for)g(columns)685
500 y(if\(\(colNumbers)f(=)h(trivsql_parsecols\(tname,)d(cols,)j
(&numCols\)\))f(==)i(NULL\){)775 582 y(return;)685 664
y(})685 829 y(//)g(How)f(we)g(have)h(the)f(right)g(number)g(of)g
(values?)685 911 y(col)h(=)f(1;)685 993 y(for\(i)g(=)h(0;)f(i)h
Fa(<)g Fe(strlen\(vals\);)d(i++\))775 1075 y(if\(vals[i])h(==)h(';'\))
865 1158 y(col++;)685 1322 y(if\(col)g(!=)g(numCols\){)775
1404 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)e(=)i
(TRIVSQL_BADVALUES;)775 1486 y(return;)685 1569 y(})685
1733 y(//)h(Save)f(each)g(column)g(value)685 1815 y(c)h(=)g
(strtok\(vals,)d(";"\);)685 1897 y(col)j(=)f(0;)685 1979
y(while\(c)g(!=)g(NULL\){)775 2062 y(t)h(=)f
(trivsql_xsnprintf\("trivsql_\045s_col\045drow\045d)o(",)39
b(tname,)44 b(colNumbers[col],)e(rowCount\);)775 2144
y(trivsql_dbwrite\(gState,)f(t,)j(c\);)775 2226 y(trivsql_xfree\(t\);)
775 2390 y(c)h(=)f(strtok\(NULL,)f(";"\);)775 2473 y(col++;)685
2555 y(})685 2719 y(//)i(And)f(we)g(should)g(keep)g(count)g(of)h(how)f
(many)g(of)h(the)f(rows)g(are)h(in)f(the)h(table)685
2801 y(t)g(=)g(trivsql_xsnprintf\("trivsql_\045s_numrow)o(s",)39
b(tname\);)685 2884 y(u)45 b(=)g(trivsql_xsnprintf\("\045d",)40
b(rowCount)k(+)h(1\);)685 2966 y(trivsql_dbwrite\(gState,)c(t,)k(u\);)
685 3048 y(trivsql_xfree\(t\);)685 3130 y(trivsql_xfree\(u\);)596
3212 y(})596 3377 y(void)f(trivsql_doselect\(char)d(*tname,)j(char)g
(*cols\){)685 3459 y(int)h(*colNumbers;)685 3541 y(int)g(row,)f
(rowCount,)f(numCols;)685 3623 y(char)h(*t,)h(*u,)f(*localCols;)685
3788 y(//)h(If)f(the)g(columns)g(list)g(is)h('*',)f(substitute)f(a)i
(list)f(of)g(all)h(the)f(columns)685 3870 y(if\(strcmp\(cols,)e("*"\))j
(==)f(0\))775 3952 y(localCols)f(=)i(trivsql_getallcolumns\(tname\);)
685 4034 y(else)775 4116 y(localCols)e(=)i(cols;)685
4281 y(//)g(Get)f(ready)g(for)g(columns)685 4363 y(if\(\(colNumbers)f
(=)h(trivsql_parsecols\(tname,)d(localCols,)i(&numCols\)\))g(==)i
(NULL\){)775 4445 y(return;)685 4527 y(})685 4692 y(//)g(Populate)e
(recordset)685 4774 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p
Fe(numCols)f(=)i(numCols;)685 4856 y(gState-)p Fa(>)p
Fe(rs-)p Fa(>)p Fe(cols)e(=)j(trivsql_xsnprintf\("\045s",)c
(localCols\);)685 4938 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p
Fe(errno)h(=)j(TRIVSQL_TRUE;)685 5103 y(//)g(Decide)e(what)i(rows)f(on)
g(the)h(table)f(match)g(the)g(select)g(condition)685
5185 y(if\(\(rowCount)f(=)i(trivsql_getrowcount\(tname\)\))40
b(==)k(-1\){)775 5267 y(return;)685 5349 y(})p Black
3601 5585 a Fd(19)p Black eop
%%Page: 20 20
20 19 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(for\(row)44 b(=)g(0;)h(row)f Fa(<)h
Fe(rowCount;)e(row++\){)775 171 y(if\(trivsql_executeselector\(gState-)
p Fa(>)p Fe(sel)o(tree,)38 b(row\))45 b(==)f(SELTRUE\))865
253 y(trivsql_addrow\(gState-)p Fa(>)p Fe(rs,)c(tname,)k(row,)g
(colNumbers\);)685 336 y(})596 418 y(})596 582 y(void)g
(trivsql_doalter\(char)d(*tname,)j(char)g(*cols\))596
664 y({)685 747 y(char)g(*t;)685 829 y(char)g(*u;)685
911 y(int)h(colCount)e(=)i(0;)685 1075 y(t)g(=)g
(trivsql_xsnprintf\("trivsql_\045s_numcol)o(s",)39 b(tname\);)685
1158 y(u)45 b(=)g(trivsql_dbread\(gState,)c(t\);)685
1240 y(if\(u)j(==)h(NULL\))f(colCount)f(=)i(0;)685 1322
y(else)f(colCount)g(=)g(atoi\(u\);)685 1404 y(trivsql_xfree\(t\);)685
1486 y(trivsql_xfree\(u\);)685 1651 y(//)h(Add)f(the)g(column)685
1733 y(t)h(=)g(trivsql_xsnprintf\("trivsql_\045s_col\045d")o(,)39
b(tname,)44 b(colCount\);)685 1815 y(trivsql_dbwrite\(gState,)d(t,)k
(cols\);)685 1897 y(trivsql_xfree\(t\);)685 1979 y(colCount++;)685
2144 y(t)g(=)g(trivsql_xsnprintf\("trivsql_\045s_numcol)o(s",)39
b(tname\);)685 2226 y(u)45 b(=)g(trivsql_xsnprintf\("\045d",)40
b(colCount\);)685 2308 y(trivsql_dbwrite\(gState,)h(t,)k(u\);)685
2390 y(trivsql_xfree\(t\);)685 2473 y(trivsql_xfree\(u\);)596
2555 y(})596 2719 y(void)f(*)596 2801 y(trivsql_xmalloc)e(\(size_t)h
(size\))596 2884 y({)685 2966 y(void)h(*buffer;)685 3130
y(if)h(\(\(buffer)e(=)i(malloc)f(\(size\)\))f(==)i(NULL\))775
3212 y({)865 3295 y(//)f(todo_mikal:)f(improve)h(this)865
3377 y(fprintf\(stderr,)e("trivsql)h(memory)h(allocation)f(error"\);)
865 3459 y(exit\(42\);)775 3541 y(})685 3706 y(return)h(buffer;)596
3788 y(})596 3952 y(void)596 4034 y(trivsql_dbwrite)e(\(trivsql_state)g
(*state,)i(char)g(*key,)g(char)g(*value\))596 4116 y({)685
4199 y(TDB_DATA)g(dbkey,)f(dbdata;)685 4363 y(if)i(\(key)f(==)g
(NULL\){)775 4445 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p
Fe(errno)e(=)i(TRIVSQL_TDBNULLKEY;)775 4527 y(return;)685
4610 y(})685 4774 y(if)h(\(value)e(==)i(NULL\){)775 4856
y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)d(=)i(TRIVSQL_TDBNULLDATA;)
775 4938 y(return;)685 5021 y(})685 5185 y(//)h(We)f(need)g(to)h(build)
f(the)g(structures)f(for)i(the)f(TDB)g(call)685 5267
y(dbkey.dptr)f(=)i(key;)685 5349 y(dbkey.dsize)e(=)i(strlen)f(\(key\))g
(+)g(1;)685 5432 y(dbdata.dptr)f(=)i(value;)p Black 197
5585 a Fd(20)p Black eop
%%Page: 21 21
21 20 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(dbdata.dsize)43 b(=)i(strlen)e(\(value\))h(+)h(1;)685
253 y(if)g(\(tdb_store)e(\(state-)p Fa(>)p Fe(db,)g(dbkey,)h(dbdata,)f
(TDB_REPLACE\))g(!=)h(0\))775 336 y({)865 418 y(gState-)p
Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)d(=)k(TRIVSQL_TDBSTOREERROR;)865
500 y(return;)775 582 y(})596 664 y(})596 829 y(char)f(*)596
911 y(trivsql_dbread)e(\(trivsql_state)g(*state,)i(char)g(*key\))596
993 y({)685 1075 y(TDB_DATA)g(dbkey,)f(dbdata;)685 1240
y(if)i(\(key)f(==)g(NULL\){)775 1322 y(gState-)p Fa(>)p
Fe(rs-)p Fa(>)p Fe(errno)e(=)i(TRIVSQL_TDBNULLKEY;)775
1404 y(return)g(NULL;)685 1486 y(})685 1651 y(//)h(We)f(need)g(to)h
(build)f(the)g(structures)f(for)i(the)f(TDB)g(call)685
1733 y(dbkey.dptr)f(=)i(key;)685 1815 y(dbkey.dsize)e(=)i(strlen)f
(\(key\))g(+)g(1;)685 1979 y(dbdata)g(=)h(tdb_fetch)e(\(state-)p
Fa(>)p Fe(db,)g(dbkey\);)685 2144 y(return)h(dbdata.dptr;)596
2226 y(})596 2390 y(char)g(*)596 2473 y(trivsql_xsnprintf)d(\(char)j
(*format,)g(...\))596 2555 y({)685 2637 y(char)g(*output)g(=)h(NULL;)
685 2719 y(int)g(size,)e(result;)685 2801 y(va_list)h(ap;)685
2966 y(/*)h(We)f(start)g(with)g(the)h(size)f(of)g(the)h(format)e
(string)h(as)h(a)f(guess)g(*/)685 3048 y(size)g(=)h(strlen)f
(\(format\);)685 3130 y(va_start)g(\(ap,)g(format\);)685
3295 y(while)g(\(1\))775 3377 y({)865 3459 y(output)f(=)i(\(char)f(*\))
g(trivsql_xrealloc)f(\(output,)g(size\);)865 3541 y(result)g(=)i
(vsnprintf)e(\(output,)h(size,)g(format,)f(ap\);)865
3706 y(if)h(\(result)g(==)g(-1\))954 3788 y({)1044 3870
y(/*)g(Up)h(to)f(glibc)g(2.0.6)g(and)h(Microsoft's)e(implementation)f
(*/)1044 3952 y(size)i(+=)g(100;)954 4034 y(})865 4116
y(else)954 4199 y({)1044 4281 y(/*)g(Check)g(if)h(we)f(are)h(done)f(*/)
1044 4363 y(if)g(\(result)g Fa(<)h Fe(size\))1133 4445
y(break;)1044 4610 y(/*)f(Glibc)g(from)g(now)h(on)f(*/)1044
4692 y(size)g(=)h(result)e(+)i(1;)954 4774 y(})775 4856
y(})685 5021 y(va_end)f(\(ap\);)685 5103 y(return)g(output;)596
5185 y(})596 5349 y(void)596 5432 y(trivsql_xfree)e(\(void)i(*memory\))
p Black 3601 5585 a Fd(21)p Black eop
%%Page: 22 22
22 21 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a Fe({)685 171 y(if)45 b(\(memory)e(!=)i(NULL\))775
253 y(free\(memory\);)596 336 y(})596 500 y(void)f(*)596
582 y(trivsql_xrealloc)e(\(void)i(*memory,)f(size_t)h(size\))596
664 y({)685 747 y(void)g(*buffer;)685 911 y(if)h(\(\(buffer)e(=)i
(realloc)e(\(memory,)h(size\)\))g(==)g(NULL\))775 993
y({)865 1075 y(fprintf\(stderr,)e("Realloc)h(of)i(memory)f(failed"\);)
865 1158 y(exit\(42\);)775 1240 y(})685 1404 y(return)g(buffer;)596
1486 y(})596 1651 y(int)g(*trivsql_parsecols\(char)d(*tname,)i(char)i
(*cols,)e(int)i(*numCols\){)685 1733 y(int)g(i,)f(col;)685
1815 y(int)h(*colNumbers)d(=)j(NULL;)685 1897 y(char)f(*t,)h(*u,)f
(*coltmp,)f(*c;)685 2062 y(//)i(How)f(many)g(columns)g(do)g(we)h(have?)
685 2144 y(*numCols)f(=)g(1;)685 2226 y(for\(i)g(=)h(0;)f(i)h
Fa(<)g Fe(strlen\(cols\);)d(i++\))775 2308 y(if\(cols[i])h(==)h(';'\))
865 2390 y(\(*numCols\)++;)685 2555 y(coltmp)g(=)h
(trivsql_xsnprintf\("\045s",)c(cols\);)685 2637 y(colNumbers)i(=)i
(trivsql_xmalloc\(sizeof\(int\))40 b(*)45 b(\(*numCols\)\);)685
2801 y(//)g(Determine)e(that)h(the)g(named)g(columns)g(exist)685
2884 y(col)h(=)f(0;)685 2966 y(c)h(=)g(strtok\(coltmp,)d(";"\);)685
3048 y(while\(c)i(!=)g(NULL\){)775 3130 y(i)h(=)f(0;)775
3212 y(while\(1\){)865 3295 y(t)g(=)h
(trivsql_xsnprintf\("trivsql_\045s_col\045d",)38 b(tname,)44
b(i\);)865 3377 y(u)g(=)h(trivsql_dbread\(gState,)c(t\);)865
3541 y(if\(u)j(==)g(NULL\){)640 3623 y(trivsql_xfree\(t\);)640
3706 y(//)h(todo_mikal:)e(this)h(make)g(break)g(if)h(used)f(during)g(a)
g(selection...)640 3788 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p
Fe(errno)e(=)j(TRIVSQL_NOSUCHCOLUMN;)640 3870 y(gState-)p
Fa(>)p Fe(rs-)p Fa(>)p Fe(errstring)c(=)k(trivsql_xsnprintf\("The)c
(column)j(\\"\045s\\")g(does)g(not)g(ex-)596 3952 y(ist)g(in)g(the)h
(table)f(\\"\045s\\")f(\(search)h(inset)g(is)h(\045d\).",)e(c,)i
(tname,)f(i\);)640 4034 y(return)g(NULL;)865 4116 y(})865
4199 y(else)g(if\(strcmp\(u,)e(c\))j(==)f(0\){)640 4281
y(trivsql_xfree\(t\);)640 4363 y(trivsql_xfree\(u\);)640
4445 y(break;)865 4527 y(})865 4692 y(trivsql_xfree\(t\);)865
4774 y(trivsql_xfree\(u\);)865 4856 y(i++;)775 4938 y(})775
5103 y(colNumbers[col])e(=)j(i;)775 5185 y(c)g(=)f(strtok\(NULL,)f
(";"\);)775 5267 y(col++;)685 5349 y(})p Black 197 5585
a Fd(22)p Black eop
%%Page: 23 23
23 22 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(return)44 b(colNumbers;)596 171 y(})596
336 y(int)g(trivsql_findcol\(char)d(*tname,)j(char)g(*cols,)g(char)g
(*col\){)685 418 y(char)g(*t,)h(*u,)f(*coltmp,)f(*c;)685
500 y(int)i(colNum;)685 664 y(coltmp)f(=)h(trivsql_xsnprintf\("\045s",)
c(cols\);)685 747 y(colNum)j(=)h(0;)685 911 y(//)g(Determine)e(that)h
(the)g(named)g(columns)g(exist)685 993 y(c)h(=)g(strtok\(coltmp,)d
(";"\);)685 1075 y(while\(c)i(!=)g(NULL\){)775 1158 y(if\(strcmp\(c,)f
(col\))h(==)g(0\))865 1240 y(return)f(colNum;)775 1404
y(c)i(=)f(strtok\(NULL,)f(";"\);)775 1486 y(colNum++;)685
1569 y(})685 1733 y(return)h(-1;)596 1815 y(})596 1979
y(int)g(trivsql_getrowcount\(char)d(*tname\){)685 2062
y(char)j(*t,)h(*u;)685 2144 y(int)g(rowCount;)685 2308
y(//)g(Determine)e(if)h(the)h(table)f(exists,)f(and)i(if)f(so)h(how)f
(many)g(rows)g(it)h(has)685 2390 y(t)g(=)g
(trivsql_xsnprintf\("trivsql_\045s_numrow)o(s",)39 b(tname\);)685
2473 y(u)45 b(=)g(trivsql_dbread\(gState,)c(t\);)685
2637 y(if\(u)j(==)h(NULL\){)775 2719 y(gState-)p Fa(>)p
Fe(rs-)p Fa(>)p Fe(errno)d(=)i(TRIVSQL_NOSUCHTABLE;)775
2801 y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errstring)d(=)k
(trivsql_xsnprintf\("Could)40 b(not)45 b(determine)e(the)h(row)h(count)
f(for)g(the)g(ta-)596 2884 y(ble)g(\\"\045s\\")g(because)f(the)i(table)
f(does)g(not)g(exist",)g(tname\);)775 2966 y(return)g(-1;)685
3048 y(})685 3212 y(rowCount)g(=)g(atoi\(u\);)685 3295
y(trivsql_xfree\(u\);)685 3377 y(trivsql_xfree\(t\);)685
3541 y(return)g(rowCount;)596 3623 y(})596 3788 y(void)g
(trivsql_addrow\(trivsql_recordset)39 b(*rs,)44 b(char)g(*tname,)g(int)
g(row,)h(int)f(*cols\){)685 3870 y(char)g(*t;)685 3952
y(int)h(colCount;)685 4034 y(trivsql_row)e(*theRow;)685
4116 y(trivsql_col)g(*theCol;)685 4281 y(//)i(Make)f(space)g(for)g(the)
g(new)h(row)685 4363 y(rs-)p Fa(>)p Fe(numRows++;)685
4445 y(theRow)f(=)h(rs-)p Fa(>)p Fe(rows;)685 4527 y(while\(theRow-)p
Fa(>)p Fe(next)d(!=)i(NULL\))775 4610 y(theRow)g(=)g(theRow-)p
Fa(>)p Fe(next;)685 4774 y(theRow-)p Fa(>)p Fe(next)f(=)i
(trivsql_xmalloc\(sizeof\(trivsql_row\)\);)685 4856 y(theRow-)p
Fa(>)p Fe(next-)p Fa(>)p Fe(next)d(=)i(NULL;)685 5021
y(theRow-)p Fa(>)p Fe(cols)f(=)i
(trivsql_xmalloc\(sizeof\(trivsql_col\)\);)685 5103 y(theRow-)p
Fa(>)p Fe(cols-)p Fa(>)p Fe(next)d(=)i(NULL;)685 5185
y(theCol)g(=)h(theRow-)p Fa(>)p Fe(cols;)685 5349 y(//)g(Get)f(the)g
(row)685 5432 y(for\(colCount)f(=)i(0;)f(colCount)g Fa(<)g
Fe(rs-)p Fa(>)p Fe(numCols;)f(colCount++\){)p Black 3601
5585 a Fd(23)p Black eop
%%Page: 24 24
24 23 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 775 89 a Fe(t)45 b(=)f
(trivsql_xsnprintf\("trivsql_\045s_col\045drow\045d)o(",)39
b(tname,)44 b(cols[colCount],)e(row\);)775 253 y(theCol-)p
Fa(>)p Fe(val)h(=)h(trivsql_dbread\(gState,)e(t\);)775
336 y(theCol-)p Fa(>)p Fe(key)h(=)h(t;)775 418 y(theCol-)p
Fa(>)p Fe(next)f(=)h(trivsql_xmalloc\(sizeof\(trivsql_col\)\);)775
500 y(theCol-)p Fa(>)p Fe(next-)p Fa(>)p Fe(next)d(=)k(NULL;)775
582 y(theCol)f(=)g(theCol-)p Fa(>)p Fe(next;)685 664
y(})596 747 y(})596 911 y(char)g(*trivsql_getallcolumns\(char)c
(*tname\))596 993 y({)685 1075 y(char)k(*t,)h(*u,)f(*retVal,)f
(*retVal2;)685 1158 y(int)i(i,)f(maxCols;)685 1322 y(t)h(=)g
(trivsql_xsnprintf\("trivsql_\045s_numcol)o(s",)39 b(tname\);)685
1404 y(u)45 b(=)g(trivsql_dbread\(gState,)c(t\);)685
1486 y(if\(u)j(==)h(NULL\))f(maxCols)f(=)i(0;)685 1569
y(else)f(maxCols)g(=)h(atoi\(u\);)685 1651 y(trivsql_xfree\(t\);)685
1733 y(trivsql_xfree\(u\);)685 1897 y(retVal)f(=)h
(trivsql_xsnprintf\(""\);)685 2062 y(for\(i)f(=)h(0;)f(i)h
Fa(<)g Fe(maxCols;)e(i++\){)865 2144 y(t)h(=)h
(trivsql_xsnprintf\("trivsql_\045s_col\045d",)38 b(tname,)44
b(i\);)865 2226 y(u)g(=)h(trivsql_dbread\(gState,)c(t\);)865
2390 y(if\(strcmp\(retVal,)g(""\))k(!=)f(0\))640 2473
y(retVal2)g(=)h(trivsql_xsnprintf\("\045s;\045s",)40
b(retVal,)k(u\);)865 2555 y(else)640 2637 y(retVal2)g(=)h
(trivsql_xsnprintf\("\045s",)c(u\);)865 2801 y(trivsql_xfree\(t\);)865
2884 y(trivsql_xfree\(u\);)865 2966 y(trivsql_xfree\(retVal\);)865
3048 y(retVal)i(=)i(retVal2;)685 3130 y(})685 3295 y(return)f(retVal;)
596 3377 y(})596 3541 y(int)g(trivsql_min\(int)e(a,)j(int)f(b\){)685
3623 y(if\(a)g Fa(>)h Fe(b\))f(return)g(b;)685 3706 y(return)g(a;)596
3788 y(})596 3952 y(void)g(trivsql_checktable\(char)d(*tname,)i
(trivsql_recordset)f(*rs\){)685 4034 y(char)i(*t,)h(*u;)685
4199 y(t)g(=)g(trivsql_xsnprintf\("trivsql_\045s_numrow)o(s",)39
b(tname\);)685 4281 y(u)45 b(=)g(trivsql_dbread\(gState,)c(t\);)685
4363 y(trivsql_xfree\(t\);)685 4527 y(if\(u)j(==)h(NULL\){)775
4610 y(\(*rs\).errno)e(=)h(TRIVSQL_NOSUCHTABLE;)775 4692
y(\(*rs\).errstring)e(=)j(trivsql_xsnprintf\("Existance)40
b(check)k(for)g(the)h(table)f(\\"\045s\\")f(de-)596 4774
y(termined)g(that)h(the)g(table)g(does)h(not)f(exist.",)f(tname\);)685
4856 y(})596 4938 y(})596 5103 y(trivsql_recordset*)e
(trivsql_makers\(char)h(*tname\){)685 5185 y(trivsql_recordset)g(*rrs;)
685 5349 y(//)j(Build)f(the)g(recordset)685 5432 y(rrs)h(=)f
(trivsql_xmalloc\(sizeof\(trivsql_recordset)o(\)\);)p
Black 197 5585 a Fd(24)p Black eop
%%Page: 25 25
25 24 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(rrs-)p Fa(>)p Fe(rows)43 b(=)i
(trivsql_xmalloc\(sizeof\(trivsql_row\)\);)685 171 y(rrs-)p
Fa(>)p Fe(rows-)p Fa(>)p Fe(next)d(=)j(NULL;)685 253
y(rrs-)p Fa(>)p Fe(rows-)p Fa(>)p Fe(cols)d(=)j(NULL;)685
336 y(rrs-)p Fa(>)p Fe(numCols)e(=)i(0;)685 418 y(rrs-)p
Fa(>)p Fe(numRows)e(=)i(0;)685 500 y(rrs-)p Fa(>)p Fe(tname)e(=)i
(trivsql_xsnprintf\("\045s",)c(tname\);)685 582 y(rrs-)p
Fa(>)p Fe(currentRow)h(=)j(rrs-)p Fa(>)p Fe(rows;)685
664 y(rrs-)p Fa(>)p Fe(errno)e(=)i(TRIVSQL_FALSE;)685
747 y(rrs-)p Fa(>)p Fe(errstring)e(=)h(NULL;)685 829
y(rrs-)p Fa(>)p Fe(cols)f(=)i(NULL;)685 993 y(if\(gState-)p
Fa(>)p Fe(db)e(==)h(NULL\){)775 1075 y(rrs-)p Fa(>)p
Fe(errno)f(=)i(TRIVSQL_DBOPENFAIL;)685 1158 y(})685 1322
y(return)f(rrs;)596 1404 y(})596 1569 y(trivsql_seltreenode*)d
(trivsql_makest\(\){)685 1651 y(trivsql_seltreenode)h(*rst;)685
1815 y(//)j(Build)f(the)g(recordset)685 1897 y(rst)h(=)f
(trivsql_xmalloc\(sizeof\(trivsql_seltreeno)o(de\)\);)685
1979 y(rst-)p Fa(>)p Fe(selArgOne)f(=)h(NULL;)685 2062
y(rst-)p Fa(>)p Fe(selColOne)f(=)h(-1;)685 2144 y(rst-)p
Fa(>)p Fe(selArgTwo)f(=)h(NULL;)685 2226 y(rst-)p Fa(>)p
Fe(selColTwo)f(=)h(-1;)685 2308 y(rst-)p Fa(>)p Fe(selector)f(=)h
(NULL;)685 2390 y(rst-)p Fa(>)p Fe(left)f(=)i(NULL;)685
2473 y(rst-)p Fa(>)p Fe(right)e(=)i(NULL;)685 2637 y(return)f(rst;)596
2719 y(})596 2884 y(trivsql_seltreenode*)d
(trivsql_makesel\(trivsql_selectorfunc)e(func,)44 b(char)g(*a1,)999
2966 y(char)g(*a2\){)685 3048 y(int)h(*colNumbers,)d(numCols;)685
3212 y(trivsql_seltreenode)g(*tst)i(=)h(trivsql_makest\(\);)685
3295 y(tst-)p Fa(>)p Fe(selector)e(=)h(func;)685 3459
y(if\(\(colNumbers)f(=)h(trivsql_parsecols\(gState-)p
Fa(>)p Fe(table,)c(a1,)k(&numCols\)\))f(==)i(NULL\){)865
3541 y(tst-)p Fa(>)p Fe(selArgOne)d(=)j(a1;)865 3623
y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)c(=)k(TRIVSQL_FALSE;)685
3706 y(})685 3788 y(else{)865 3870 y(tst-)p Fa(>)p Fe(selColOne)d(=)j
(colNumbers[0];)685 3952 y(})685 4034 y(trivsql_xfree\(colNumbers\);)
685 4199 y(if\(\(colNumbers)e(=)h(trivsql_parsecols\(gState-)p
Fa(>)p Fe(table,)c(a2,)k(&numCols\)\))f(==)i(NULL\){)865
4281 y(tst-)p Fa(>)p Fe(selArgTwo)d(=)j(a2;)865 4363
y(gState-)p Fa(>)p Fe(rs-)p Fa(>)p Fe(errno)c(=)k(TRIVSQL_FALSE;)685
4445 y(})685 4527 y(else{)865 4610 y(tst-)p Fa(>)p Fe(selColTwo)d(=)j
(colNumbers[0];)685 4692 y(})685 4774 y(trivsql_xfree\(colNumbers\);)
685 4938 y(return)f(tst;)596 5021 y(})596 5185 y(trivsql_seltreenode*)d
(trivsql_makeslr\(trivsql_selectorfunc)e(func,)999 5267
y(trivsql_seltreenode)j(*left,)999 5349 y(trivsql_seltreenode)g
(*right\){)685 5432 y(trivsql_seltreenode*)g(tst)i(=)h
(trivsql_makest\(\);)p Black 3601 5585 a Fd(25)p Black
eop
%%Page: 26 26
26 25 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 89 a Fe(tst-)p Fa(>)p Fe(selector)43 b(=)h(func;)685
171 y(tst-)p Fa(>)p Fe(left)f(=)i(left;)685 253 y(tst-)p
Fa(>)p Fe(right)e(=)i(right;)596 336 y(})596 500 y(int)f
(trivsql_executeselector\(trivsql_seltre)o(enode*)38
b(node,)44 b(int)h(row\){)685 582 y(char)f(*a1,)g(*a2,)h(*t;)685
747 y(if\(node)f(==)g(NULL\))775 829 y(return)g(SELTRUE;)685
993 y(if\(\(\(node-)p Fa(>)p Fe(selArgOne)e(!=)i(NULL\))g(||)h(\(node-)
p Fa(>)p Fe(selColOne)d(!=)i(-1\)\))g(&&)820 1075 y(\(\(node-)p
Fa(>)p Fe(selArgTwo)e(!=)i(NULL\))g(||)h(\(node-)p Fa(>)p
Fe(selColTwo)d(!=)i(-1\)\)\){)775 1158 y(if\(node-)p
Fa(>)p Fe(selColOne)e(==)i(-1\))865 1240 y(a1)g(=)h(node-)p
Fa(>)p Fe(selArgOne;)775 1322 y(else{)865 1404 y(t)f(=)h
(trivsql_xsnprintf\("trivsql_\045s_col\045drow)o(\045d",)39
b(gState-)p Fa(>)p Fe(table,)909 1486 y(node-)p Fa(>)p
Fe(selColOne,)j(row\);)865 1569 y(a1)i(=)h(trivsql_dbread\(gState,)c
(t\);)865 1651 y(trivsql_xfree\(t\);)865 1815 y(if\(a1)i(==)i(NULL\))
640 1897 y(return)f(SELFALSE;)775 1979 y(})775 2144 y(if\(node-)p
Fa(>)p Fe(selColTwo)e(==)i(-1\))865 2226 y(a2)g(=)h(node-)p
Fa(>)p Fe(selArgTwo;)775 2308 y(else{)865 2390 y(t)f(=)h
(trivsql_xsnprintf\("trivsql_\045s_col\045drow)o(\045d",)39
b(gState-)p Fa(>)p Fe(table,)909 2473 y(node-)p Fa(>)p
Fe(selColTwo,)j(row\);)865 2555 y(a2)i(=)h(trivsql_dbread\(gState,)c
(t\);)865 2637 y(trivsql_xfree\(t\);)865 2801 y(if\(a2)i(==)i(NULL\))
640 2884 y(return)f(SELFALSE;)775 2966 y(})775 3130 y(return)g(\(node-)
p Fa(>)p Fe(selector\)\(a1,)d(a2\);)685 3212 y(})685
3377 y(return)j(\(node-)p Fa(>)p Fe(selector\)\(trivsql_executeselecto)
o(r\(node)o(-)p Fa(>)p Fe(lef)o(t,)39 b(row\),)820 3459
y(trivsql_executeselector\(node-)p Fa(>)p Fe(right,)f(row\)\);)596
3541 y(})596 3706 y(int)44 b(trivsql_initok\(trivsql_state)c(*state\){)
685 3788 y(if\(state-)p Fa(>)p Fe(db)j(==)h(NULL\))775
3870 y(return)g(TRIVSQL_FALSE;)685 3952 y(return)g(TRIVSQL_TRUE;)596
4034 y(})596 4209 y Fd(Code:)20 b(/home/mikal/opensour)o
(ce/trivsql/internal.c)596 4374 y Fe(#include)43 b("trivsql.h")596
4456 y(#include)g Fa(<)p Fe(string.h)p Fa(>)596 4620
y Fe(int)h(trivsql_selequal\(char)d(*arg1,)j(char)g(*arg2\){)685
4703 y(if\(strcmp\(arg1,)e(arg2\))i(==)h(0\))f(return)g(SELTRUE;)685
4785 y(return)g(SELFALSE;)596 4867 y(})596 5031 y(//)g(todo:)g
(implement)f(\045's)596 5114 y(int)h(trivsql_sellike\(char)d(*arg1,)j
(char)g(*arg2\){)685 5196 y(int)h(front)e(=)i(0,)g(back)f(=)g(0,)h
(ret;)685 5278 y(char)f(*sel,)g(*str;)685 5442 y(sel)h(=)f
(strdup\(arg2\);)p Black 197 5585 a Fd(26)p Black eop
%%Page: 27 27
27 26 bop Black 0 TeXcolorgray Black 2034 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 685 171 a Fe(if\(arg2[0])43 b(==)i('\045'\){)775
253 y(front)f(=)g(1;)775 336 y(sel++;)685 418 y(})685
582 y(if\(arg2[strlen\(arg2\))e(-)i(1])h(==)f('\045'\){)775
664 y(back)g(=)h(1;)775 747 y(sel[strlen\(sel\))d(-)j(1])f(=)h('\\0';)
685 829 y(})685 993 y(printf\("\045d)e(\045d)i(\(\045s\)\\n",)e(front,)
h(back,)g(sel\);)685 1158 y(if\(\(str)g(=)g(strstr\(arg1,)f(sel\)\))h
(!=)h(NULL\){)775 1240 y(if\(\(front)e(==)i(1\))f(&&)h(\(str)f(==)g
(arg1\)\))865 1322 y(ret)g(=)g(SELFALSE;)775 1404 y(else)865
1486 y(ret)g(=)g(SELTRUE;)685 1569 y(})685 1651 y(else)g(ret)h(=)f
(SELFALSE;)685 1815 y(//trivsql_xfree\(sel\);)685 1897
y(return)g(ret;)596 1979 y(})596 2144 y(int)g(trivsql_selor\(int)e
(left,)i(int)g(right\){)685 2226 y(if\(left)g(==)g(SELTRUE\))g(return)g
(SELTRUE;)685 2308 y(if\(right)g(==)g(SELTRUE\))g(return)f(SELTRUE;)685
2390 y(return)h(SELFALSE;)596 2473 y(})596 2637 y(int)g
(trivsql_seland\(int)e(left,)i(int)g(right\){)685 2719
y(if\(left)g(==)g(SELFALSE\))g(return)f(SELFALSE;)685
2801 y(if\(right)h(==)g(SELFALSE\))f(return)h(SELFALSE;)685
2884 y(return)g(SELTRUE;)596 2966 y(})596 3140 y Fd(Code:)20
b(/home/mikal/opensour)o(ce/trivsql/selectors.c)596 3305
y Fe(#include)43 b Fa(<)p Fe(stdio.h)p Fa(>)596 3388
y Fe(#include)g("trivsql.h")596 3552 y(int)h(main\(int)f(argc,)h(char)g
(*argv[]\){)685 3634 y(trivsql_state)f(*ourState;)685
3716 y(trivsql_recordset)f(*rs;)685 3799 y(char)i(cmd[1000];)685
3963 y(if\(argc)g(!=)g(2\){)775 4045 y(fprintf\(stderr,)e("Please)i
(specify)f(a)i(db)g(file\\n"\);)775 4127 y(exit\(42\);)685
4209 y(})685 4374 y(ourState)f(=)g(trivsql_opendb\(argv[1]\);)685
4456 y(if\(trivsql_initok\(ourState\))c(!=)45 b(TRIVSQL_TRUE\){)775
4538 y(fprintf\(stderr,)d("Database)h(open)i(failed\\n"\);)775
4620 y(exit\(42\);)685 4703 y(})685 4867 y(while\(fgets\(cmd,)d(1000,)i
(stdin\))g(!=)h(NULL\){)775 4949 y(rs)f(=)h(trivsql_execute\(ourState,)
c(cmd\);)775 5031 y(if\(rs)j(!=)g(NULL\))g(trivsql_displayrs\(rs\);)775
5114 y(else)g(printf\("NULL)f(recordset\\n"\);)775 5196
y(trivsql_xfree\(rs\);)685 5278 y(})596 5360 y(})p Black
3601 5585 a Fd(27)p Black eop
%%Page: 28 28
28 27 bop Black 0 TeXcolorgray Black 197 -132 a Fd(trivsql:)21
b(A)g(trivial)f(SQL)h(engine)g(for)g(your)f(application)p
Black 596 89 a(Code:)g(/home/mikal/opensour)o(ce/trivsql/example.c)596
222 y Fg(I)d(haven't)h(included)g(the)g(TDB)f(code,)g(as)h(it)g(is)g
(not)h(strictly)f(part)f(of)h Fi(trivsql)p Fg(,)e(and)h(may)h(be)g
(down-)596 313 y(loaded)h(fr)o(om)i(http://www)-8 b(.samba.or)o(g)197
642 y Fj(Notes)p Black 596 789 a Fg(1.)p Black 69 w(Ther)o(e)25
b(ar)o(e)g(also)g(functions)i(which)g(allow)f(you)g(to)h(do)e(slightly)
i(mor)o(e)f(inter)o(esting)g(opera-)728 880 y(tions,)c(such)f(as)g
(enumerating)g(all)f(of)h(the)g(keys)g(de\002ned)f(in)h(the)g
(database.)p Black 197 5585 a Fd(28)p Black eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
